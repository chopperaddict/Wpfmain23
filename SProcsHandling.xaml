<Window x:Class="Wpfmain.SProcsHandling" 
		xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
		xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
		xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
		xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
		xmlns:collections="clr-namespace:System.Collections;assembly=mscorlib"
		xmlns:sys="clr-namespace:System;assembly=mscorlib"
		xmlns:local="clr-namespace:Wpfmain" 
		xmlns:app="clr-namespace:Wpfmain" 
		xmlns:conv="clr-namespace:Wpfmain.Converters" 
		xmlns:System="clr-namespace:System;assembly=netstandard"
		mc:Ignorable="d" 
		Loaded="Window_Loaded" 
		Closing="SProcsViewer_Closing"
		Background="{StaticResource Black4}" 
		WindowChrome.ResizeGripDirection="BottomRight"
		ResizeMode="CanResizeWithGrip" 
		SizeChanged="Win_SizeChanged "
		PreviewKeyDown="ResultsEscapeKeyDown"
		PreviewMouseRightButtonDown="MenuControl_ExecShowContextMenu"
		PreviewMouseLeftButtonUp="SProcsViewer_MouseLeftButtonUp"
		PreviewMouseLeftButtonDown="SProcsViewer_MouseLeftButtonDown"
		Top = "100"
		Left = "325"
		Height = "870"
		Width = "1000"		
		Title="Sql Tables and Stored Procedures Access System (by Ian Turner 1/2022) "
		x:Name="SProcsViewer"
		WindowStyle="SingleBorderWindow"
		WindowStartupLocation="Manual"
		KeyDown="SProcsViewer_KeyDown"
		MinHeight="650" MinWidth="900">

	<!--#end of window header properties-->

	<Window.Resources>

		<!--#region converters etc declarations-->

		<local:ReduceByParamValue2 x:Key="ReduceByParamValue" />
		<local:SprocsHandlingViewmodel x:Key="SprocsHandlingViewmodel "/>
		<conv:SprocsControlsMultiConverter x:Key="SprocsMultiConverter"/>
		<conv:SetMenuColorExampleConverter x:Key="SetMenuColorConverter"/>
		<conv:ComboTextColorConverter x:Key="ComboTextColorConverter"/>
		<conv:SetMenuFontSizeConverter x:Key="SetFontSizeConverter"/>
		<conv:SetComboTextConverter x:Key="SetComboTextConverter"/>
		<SolidColorBrush x:Key="TextBlockSelectedForegroundBrush" Color="Red" />
		<SolidColorBrush x:Key="TextSelectionHighlightColorThemeBrush" Color="Black"/>

		<!--#endregion converters etc declarations-->

		<!--#region StoryBoards-->

		<Storyboard x:Key="ToggleBkGroundAnimation" Duration="0:0:5" >
			<ColorAnimation Storyboard.TargetProperty="(TextBlock.Background).(SolidColorBrush.Color)"
                        Storyboard.TargetName="ExecResult"
                        To="{Binding Source={StaticResource Yellow4}, Path=Color}"
                        AutoReverse="True"
                        Duration="0:0:1"/>
		</Storyboard>

		<!--<TextBlock.EnterActions>
					<StopStoryboard BeginStoryboardName="bidUpStoryboard"/>
					<StopStoryboard BeginStoryboardName="bidDownStoryboard"/>
					<BeginStoryboard Name="bidUpStoryboard">
						<Storyboard BeginTime="00:00:00">
							<ColorAnimation 
                        BeginTime="00:00:00"
                        Duration="0:0:0.1" 
                        To="{StaticResource Yellow3}" 
						From="{StaticResource ClrGreen5}"
                        AutoReverse="True"
                        Storyboard.TargetName="Exec" 
                        Storyboard.TargetProperty="(TextBlock.Background).(SolidColorBrush.Color)">
							</ColorAnimation>
						</Storyboard>
					</BeginStoryboard>
				</TextBlock.EnterActions>

						<TextBlock.EnterActions>
				<StopStoryboard BeginStoryboardName="bidUpStoryboard"/>
					<StopStoryboard BeginStoryboardName="bidDownStoryboard"/>
					<BeginStoryboard Name="bidDownStoryboard">
						<Storyboard BeginTime="00:00:00">
							<ColorAnimation 
                        BeginTime="00:00:00"
                        Duration="0:0:0.1" 
                        To="Red" 
                        AutoReverse="True"
                        Storyboard.TargetName="txtTextBlock" 
                        Storyboard.TargetProperty="(TextBlock.Background).(SolidColorBrush.Color)">
							</ColorAnimation>
						</Storyboard>
					</BeginStoryboard>
				</TextBlock.EnterActions>-->
		<!--#endregion StoryBoards-->

		<!--#region styles-->

		<Style x:Key="SProcsResultsListboxStyle" TargetType="{x:Type ListBoxItem}">
			<Setter
			Property="Template">
				<Setter.Value>
					<ControlTemplate
					TargetType="{x:Type ListBoxItem}">
						<Border
						x:Name="Bd"
						SnapsToDevicePixels="true">
							<ContentPresenter
							x:Name="Contentpresenter"
							HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
							SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
							VerticalAlignment="{TemplateBinding VerticalContentAlignment}" />
						</Border>
						<ControlTemplate.Triggers>
							<MultiTrigger>
								<MultiTrigger.Conditions>
									<Condition Property="IsMouseOver" Value="False" />
									<Condition Property="IsSelected" Value="false" />
								</MultiTrigger.Conditions>
								<Setter Property="Background" TargetName="Bd" Value="{StaticResource White4}" />
								<Setter Property="TextElement.Foreground" TargetName="Contentpresenter" Value="{StaticResource Blue2}" />
								<Setter Property="TextElement.FontWeight" TargetName="Contentpresenter" Value="Normal" />
								<Setter Property="Padding" TargetName="Bd" Value="10,0,0,0" />
							</MultiTrigger>
							<MultiTrigger>
								<MultiTrigger.Conditions>
									<Condition Property="IsMouseOver" Value="true" />
									<Condition Property="IsSelected" Value="true" />
								</MultiTrigger.Conditions>
								<Setter Property="Background" TargetName="Bd" Value="{StaticResource Green7}" />
								<Setter Property="TextElement.Foreground" TargetName="Bd" Value="{StaticResource Red0}" />
								<Setter Property="TextElement.FontWeight" TargetName="Contentpresenter" Value="Normal" />
								<Setter Property="Padding" TargetName="Bd" Value="10,0,0,0" />
							</MultiTrigger>
							<MultiTrigger>
								<MultiTrigger.Conditions>
									<Condition Property="IsMouseOver" Value="False" />
									<Condition Property="IsSelected" Value="true" />
								</MultiTrigger.Conditions>
								<Setter Property="Background" TargetName="Bd" Value="{StaticResource Purple4}" />
								<Setter Property="TextElement.Foreground" TargetName="Contentpresenter" Value="{StaticResource White1}" />
								<Setter Property="TextElement.FontWeight" TargetName="Contentpresenter" Value="DemiBold" />
								<Setter Property="Padding" TargetName="Bd" Value="10,0,0,0" />
							</MultiTrigger>
							<MultiTrigger>
								<MultiTrigger.Conditions>
									<Condition Property="IsMouseOver" Value="true" />
									<Condition Property="IsSelected" Value="false" />
								</MultiTrigger.Conditions>
								<Setter Property="Background" TargetName="Bd" Value="{StaticResource Orange3}" />
								<Setter Property="TextElement.Foreground" TargetName="Contentpresenter" Value="{StaticResource Black0}" />
								<Setter Property="TextElement.FontWeight" TargetName="Contentpresenter" Value="Normal" />
								<Setter Property="Width" TargetName="Contentpresenter" Value="3000" />
								<Setter Property="Padding" TargetName="Bd" Value="10,0,0,0" />
							</MultiTrigger>
						</ControlTemplate.Triggers>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>

		<!--//*** IMPORTANT STYLE *** //-->
		<ItemsPanelTemplate x:Key="SPNoImageMenu">
			<!--// Stackpanel controls the background color of  the menu when mouse if over (hihligted)-->
			<!--and also the overall width of each menu item and its margins -->
			<StackPanel Margin="0,0,0,0" Background="Green" Width="300">
			</StackPanel>
		</ItemsPanelTemplate>

		<ItemsPanelTemplate x:Key="MainNoImageMenu">
			<!--// Stackpanel controls the background color of  the menu when mouse if over (hihligted)-->
			<!--and also the overall width of each menu item and its margins -->
			<StackPanel Margin="0,0,0,0" Background="Green" Width="50">
			</StackPanel>
		</ItemsPanelTemplate>

		<!--/******************************************************/-->
		<!--Special style for sprocs execution results listbox-->
		<!--/******************************************************/-->


		<!--#region menu styles-->
		<Style x:Key="ContextMenuStyle" TargetType="MenuItem">
			<!--// REQUIRED to loose blank image area at left of menuitem-->
			<Setter Property="ItemsPanel" Value="{StaticResource SPNoImageMenu}" />
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type MenuItem}">
						<Border x:Name="Bd" Padding="12,0,0,0" 
								BorderBrush="{TemplateBinding BorderBrush}"
								BorderThickness="{TemplateBinding BorderThickness}"
								Background="{TemplateBinding Background}" 
								SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
									Uid="Border_38">

							<ContentPresenter x:Name="ContentPresenter" 
									Content="{TemplateBinding Header}"
									TextElement.Foreground="{TemplateBinding Foreground}" 
									ContentSource="Header" 
									TextElement.FontWeight="{TemplateBinding FontWeight}"
									TextElement.FontSize="15"
									Margin="{TemplateBinding Padding}"
									RecognizesAccessKey="True"
									SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
									Uid="ContentPresenter_33" />
						</Border>

						<ControlTemplate.Triggers>
							<MultiTrigger>
								<MultiTrigger.Conditions>
									<Condition Property="IsMouseOver" Value="true" />
								</MultiTrigger.Conditions>
								<MultiTrigger.Setters>
									<Setter Property="FontWeight" Value="DemiBold" />
									<Setter Property="Background"		 Value="Red" />
								</MultiTrigger.Setters>
							</MultiTrigger>
							<MultiTrigger>
								<MultiTrigger.Conditions>
									<Condition Property="IsHighlighted" Value="true" />
								</MultiTrigger.Conditions>
								<MultiTrigger.Setters>
									<Setter Property="FontWeight" Value="DemiBold" />
									<Setter Property="Background"		 Value="Red" />
								</MultiTrigger.Setters>
							</MultiTrigger>
						</ControlTemplate.Triggers>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>
		<!--#endregion menu styles-->

		<!--#region textblock-->
		<Style x:Key="Textblockstyle1" TargetType="TextBlock">
			<Style.Triggers>
				<Trigger Property="IsMouseOver" Value="true" />
			</Style.Triggers>
			<Style.Setters>
				<Setter Property="Background" Value="Green" />
			</Style.Setters>
		</Style>
		<!--#endregion -->

		<!--#region -->
		<Style x:Key="BtnStyle1" TargetType="Button">
			<!--Default layout-->
			<Setter Property="OverridesDefaultStyle" Value="false" />
			<Setter Property="OverridesDefaultStyle" Value="True" />

			<!--Lets change the Border as well but use the colors
			defined in the Buttons declaration in the xaml code-->
			<Setter Property="Background" Value="DarkOrange" />
			<Setter Property="Foreground" Value="Black" />

			<Setter Property="Control.Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type Button}">
						<Border x:Name="bd" Background="{TemplateBinding Background}"
								BorderBrush="{TemplateBinding BorderBrush}"
								BorderThickness="{TemplateBinding BorderThickness}" CornerRadius="5 5 5 5">

							<!--MOST IMPORTANT the ContentPresenter lives here and displays our
							"Content" text correctly NB: Interestingly, it is in the BORDER which
							is the Outermost part of a buttons "design" as shown very clearly in
							the Visual Tree so that is where I need to put it with other controls-->

							<!--V.Tree shows that inside the ContentPresenter is a StackPanel that
							actually contains the Contents text-->
							<TextBlock HorizontalAlignment="Center" VerticalAlignment="Center"
									Text="{TemplateBinding Content}" />
							<!--<ContentPresenter
							Margin="2"
							HorizontalAlignment="Center"
							VerticalAlignment="Center"
							RecognizesAccessKey="True" />-->

						</Border>
					</ControlTemplate>
				</Setter.Value>
			</Setter>

			<!--Now to handle those pesky Triggers-->
			<Style.Triggers>
				<!--<MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="IsMouseOver" Value="false"/>
                 </MultiTrigger.Conditions>
                <MultiTrigger.Setters>
                    <Setter Property="Background" Value="DarkOrange" />
                 </MultiTrigger.Setters>
            </MultiTrigger>-->
				<MultiTrigger>
					<MultiTrigger.Conditions>
						<Condition Property="IsMouseOver" Value="true" />
					</MultiTrigger.Conditions>
					<MultiTrigger.Setters>
						<Setter Property="Background" Value="{StaticResource Green5}" />
					</MultiTrigger.Setters>
				</MultiTrigger>
			</Style.Triggers>
		</Style>
		<!--#endregion -->

		<!--#region -->
		<Style x:Key="BtnStyle2" TargetType="{x:Type Border}">
			<!--Default layout-->
			<Setter Property="OverridesDefaultStyle" Value="true" />
			<!--Now to handle those pesky Triggers-->
			<Style.Triggers>
				<MultiTrigger>
					<MultiTrigger.Conditions>
						<Condition Property="IsMouseOver" Value="false" />
					</MultiTrigger.Conditions>
					<MultiTrigger.Setters>
						<Setter Property="Background" Value="DarkOrange" />
					</MultiTrigger.Setters>
				</MultiTrigger>
				<MultiTrigger>
					<MultiTrigger.Conditions>
						<Condition Property="IsMouseOver" Value="true" />
					</MultiTrigger.Conditions>
					<MultiTrigger.Setters>
						<Setter Property="Background" Value="{StaticResource Cyan4}" />
					</MultiTrigger.Setters>
				</MultiTrigger>

				<MultiTrigger>
					<MultiTrigger.Conditions>
						<Condition Property="IsEnabled" Value="false" />
					</MultiTrigger.Conditions>
					<MultiTrigger.Setters>
						<Setter Property="Opacity" Value="0.7" />
						<Setter Property="Background" Value="{StaticResource Gray3}" />
						<Setter Property="TextElement.Foreground" Value="Red" />
					</MultiTrigger.Setters>
				</MultiTrigger>
			</Style.Triggers>
		</Style>
		<!--#endregion -->

		<!--#region // NON working datagrid style-->
		<Style x:Key="dgridstyle" TargetType="DataGridCell" >
			<!--<Setter Property="OverridesDefaultStyle" Value="true" />-->
			<Style.Triggers>
				<MultiTrigger >
					<MultiTrigger.Conditions>
						<!--<Condition Property="IsMouseOver" Value="false"/>-->
						<Condition Binding="{Binding RelativeSource={RelativeSource Self}, Path=IsSelected}" Value="false" />
						<Condition Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=DataGridRow}, Path=IsMouseOver}" Value="false" />
						<!--<Condition Property="IsHighlighted" Value="false"/>-->
					</MultiTrigger.Conditions>
					<MultiTrigger.Setters>
						<Setter Property="Background" Value="{StaticResource White1}" />
						<Setter Property="Foreground"  Value="Purple" />
						<Setter Property="BorderBrush" Value="{StaticResource White1}" />
						<Setter Property="BorderThickness" Value="0" />
						<Setter Property="{Binding RelativeSource={RelativeSource Self}, Path=RowHeight}" Value="25" />
						<Setter Property="BorderThickness" Value="0" />
					</MultiTrigger.Setters>
				</MultiTrigger>
				<MultiTrigger >
					<MultiTrigger.Conditions>
						<!--<Condition Property="IsMouseOver" Value="true"/>-->
						<Condition Binding="{Binding RelativeSource={RelativeSource Self}, Path=IsSelected}" Value="True" />
						<Condition Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=DataGridRow}, Path=IsMouseOver}" 			Value="true" />
						<!--<Condition Property="IsSelected" Value="true"/>-->
					</MultiTrigger.Conditions>
					<MultiTrigger.Setters>
						<!--<Setter Property="DataGrid.Background" Value="{StaticResource Red2}" />-->
						<Setter Property="Background" Value="{StaticResource Red5}" />
						<Setter Property="TextElement.Foreground" Value="{StaticResource White0}" />
						<Setter Property="BorderBrush" Value="{StaticResource Yellow1}" />
						<Setter Property="{Binding RelativeSource={RelativeSource Self}, Path=RowHeight}" Value="25" />
						<Setter Property="BorderThickness" Value="0" />
					</MultiTrigger.Setters>
				</MultiTrigger>
				<MultiTrigger >
					<MultiTrigger.Conditions>
						<!--<Condition Property="IsMouseOver" Value="true"/>-->
						<Condition Property="IsSelected" Value="True" />
						<Condition Property="IsMouseOver"	Value="false" />
						<!--<Condition Property="IsSelected" Value="true"/>-->
					</MultiTrigger.Conditions>
					<MultiTrigger.Setters>
						<!--<Setter Property="DataGrid.Background" Value="{StaticResource Red2}" />-->
						<Setter Property="Background" Value="{StaticResource Black0}" />
						<Setter Property="TextElement.Foreground" Value="{StaticResource White0}" />
						<Setter Property="BorderBrush" Value="{StaticResource Purple5}" />
						<Setter Property="{Binding RelativeSource={RelativeSource Self}, Path=RowHeight}" Value="25" />
						<Setter Property="BorderThickness" Value="0" />
					</MultiTrigger.Setters>
				</MultiTrigger>
			</Style.Triggers>
		</Style>
		<!--#endregion -->

		<!--#region// working datagrid style-->
		<Style x:Key="DataGridStyleBlue" TargetType="DataGridCell" BasedOn="{StaticResource {x:Type DataGridCell}}">
			<Style.Triggers>
				<!--#region Triggers-->

				<!--NOT SELECTED,  MOUSEOVER / FALSE-->
				<!--1, False, False -->
				<MultiDataTrigger>
					<MultiDataTrigger.Conditions>
						<!--//Working !!-->
						<!--<Condition Binding="{Binding ElementName=DataGridRow, Path=IsSelected}" Value="False" />-->
						<Condition Binding="{Binding ElementName=SPDatagrid, Path=IsFocused}" Value="true" />
						<Condition Binding="{Binding ElementName=SPDatagrid, Path=IsSelected}" Value="False" />
						<Condition Binding="{Binding ElementName=SPDatagrid, Path=IsMouseOver}" Value="False" />
					</MultiDataTrigger.Conditions>
					<MultiDataTrigger.Setters>
						<Setter Property="Background" Value="{StaticResource Cyan0}" />
						<Setter Property="Foreground" Value="{StaticResource Red0}" />
						<!--<Setter Property="BorderBrush" Value="{StaticResource White0}" />
						<Setter Property="BorderThickness" Value="0" />-->
						<Setter Property="FontWeight" Value="Bold" />
					</MultiDataTrigger.Setters>
				</MultiDataTrigger>

				<!--NOT SELECTED,  MOUSEOVER / TRUE-->
				<!--1, False, True -->
				<MultiDataTrigger>
					<MultiDataTrigger.Conditions>
						<!--//Working !!-->
						<Condition Binding="{Binding RelativeSource={RelativeSource AncestorType=DataGridRow}, Path=IsSelected}" Value="False" />
						<Condition Binding="{Binding RelativeSource={RelativeSource AncestorType=DataGridRow}, Path=IsMouseOver}" Value="True" />
					</MultiDataTrigger.Conditions>
					<MultiDataTrigger.Setters>
						<Setter Property="Background" Value="{StaticResource Orange2}" />
						<Setter Property="FontWeight" Value="Normal" />
						<!--<Setter Property="Foreground" Value="{StaticResource White0}" />-->
					</MultiDataTrigger.Setters>
				</MultiDataTrigger>
				<!-- SELECTED,  MOUSEOVER / TRUE-->
				<!--1, True, True -->
				<MultiDataTrigger>
					<!--//Working !!-->
					<MultiDataTrigger.Conditions>
						<Condition Binding="{Binding RelativeSource={RelativeSource AncestorType=DataGridRow}, Path=IsSelected}" Value="True" />
						<Condition Binding="{Binding RelativeSource={RelativeSource AncestorType=DataGridRow}, Path=IsMouseOver}" Value="True" />
					</MultiDataTrigger.Conditions>
					<MultiDataTrigger.Setters>
						<Setter Property="Background" Value="{StaticResource Red8}" />
						<!--<Setter Property="Foreground" Value="{StaticResource White0}" />-->
						<Setter Property="FontWeight" Value="Normal" />
					</MultiDataTrigger.Setters>
				</MultiDataTrigger>

				<!-- SELECTED,  MOUSEOVER / FALSE-->
				<MultiDataTrigger>
					<!--// NOT WORKIING ???????-->
					<MultiDataTrigger.Conditions>
						<Condition Binding="{Binding RelativeSource={RelativeSource AncestorType=DataGridRow}, Path=IsSelected}" Value="True" />
						<Condition Binding="{Binding RelativeSource={RelativeSource AncestorType=DataGridRow}, Path=IsMouseOver}" Value="false" />
					</MultiDataTrigger.Conditions>
					<MultiDataTrigger.Setters>
						<Setter Property="Background" Value="{StaticResource Purple3}" />
						<!--<Setter Property="Foreground" Value="{StaticResource White0}" />-->
						<Setter Property="FontWeight" Value="Normal" />
					</MultiDataTrigger.Setters>
				</MultiDataTrigger>

				<!--#### ACTYPE = 1 ####-->
				<!-- SELECTED,  MOUSEOVER / FALSE-->
				<!--1, True, False -->
				<MultiDataTrigger>
					<MultiDataTrigger.Conditions>
						<Condition Binding="{Binding RelativeSource={RelativeSource Self}, Path=IsSelected}" Value="true" />
						<Condition Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=DataGridRow}, Path=IsMouseOver}" Value="False" />
					</MultiDataTrigger.Conditions>
					<MultiDataTrigger.Setters>
						<Setter Property="Background" Value="{StaticResource Green6}" />
						<Setter Property="DataGridRow.Foreground" Value="{StaticResource White0}" />
						<Setter Property="FontWeight" Value="Normal" />
					</MultiDataTrigger.Setters>
				</MultiDataTrigger>

				<!--#endregion Triggers-->
			</Style.Triggers>
		</Style>
		<!--#endregion -->

		<!--#endregion Styles-->

		<!--#region sundry utils-->

		<LinearGradientBrush  x:Key="WarningRed"
			StartPoint="0.2, 0" EndPoint="0.6, 1">
			<GradientStop Offset="0" Color="{StaticResource ClrGreen8}" />
			<GradientStop Offset=".5" Color="{StaticResource ClrOrange7}" />
			<!--<GradientStop Offset=".6" Color="{StaticResource ClrWhite6}" />-->
			<GradientStop Offset="1" Color="{StaticResource ClrWhite0}" />
		</LinearGradientBrush>

		<!--#endregion sundry utils-->

		<!--#region SP Context Menu-->

		<ContextMenu x:Key="SProcsContextmenu" 
				Width="310"
				HorizontalOffset="-120"
				VerticalOffset="10"
				Background="{StaticResource White4}"
				Visibility="Hidden">
			<!--// ALWAYS USE THIS to remove Annoying Image panel at left-->
			<ContextMenu.Style>
				<Style TargetType="{x:Type ContextMenu}">
					<Setter Property="ItemsPanel" Value="{StaticResource SPNoImageMenu}" />
				</Style>
			</ContextMenu.Style>

			<MenuItem Name="showdgrid" 
					Width="320" 
					Padding="10 1 0 0"
					HorizontalAlignment="Center"
					Header="Switch to SQL Data Grid View" 	
					ToolTip="Show currently selected Sql Table in upper pane"
					ToolTipService.HorizontalOffset="40"
					ToolTipService.VerticalOffset="15"
					ToolTipService.HasDropShadow="True"
					ToolTipService.Placement="Mouse"
					ToolTipService.BetweenShowDelay="5000"
					ToolTipService.InitialShowDelay="2500"
					Style="{StaticResource ContextMenuStyle}"
					Background="{StaticResource Red4}"
					Foreground="White" 
					Click="show_DataGrid" 
					PreviewMouseRightButtonUp="DoHandled" />

			<MenuItem Name="spseteditpanelheight" 
					Width="300" 
					Height="30"
					Padding="0 5 0 0"
					Header="Show/Fit lower panel in Window"
					ToolTip="Show full Edit Panel and resize Sql Table grid to fit Window correctly"
					ToolTipService.HorizontalOffset="40"
					ToolTipService.VerticalOffset="10"
					Style="{StaticResource ContextMenuStyle}"
					Background="{StaticResource Green8}"
					Foreground="Black"
					PreviewMouseRightButtonUp="DoHandled" 
					Click="ResetPanelSplit"/>

			<!--#region SQL Scrit Editpor-->

			<MenuItem Name="spexecutespeditor"
					Width="320" 
					Height="30"
					Padding="10 8 0 0"
					HorizontalAlignment="Center"
					Header="EXECUTE new SQL Script"
					ToolTip="EXECUTEnew SQL script ..."
					ToolTipService.HorizontalOffset="40"
					ToolTipService.VerticalOffset="15"
					ToolTipService.HasDropShadow="True"
					ToolTipService.Placement="Mouse"
					ToolTipService.BetweenShowDelay="5000"
					ToolTipService.InitialShowDelay="2500"
					Style="{StaticResource ContextMenuStyle}"
					Background="{StaticResource Green8}"
					Foreground="Black" 
					FontSize="18"
					IsEnabled="True" 
					PreviewMouseRightButtonUp="DoHandled"
					Click="ExecuteNewSprocs" />

			<MenuItem Name="spprintscript"
					Width="320" 
					Height="30"
					Padding="0 5 0 0"
					Header="Print current script"
					ToolTip="Show Print dialog to allow current SQL script to be printed"
					ToolTipService.HorizontalOffset="40"
					ToolTipService.VerticalOffset="15"
					ToolTipService.HasDropShadow="True"
					ToolTipService.Placement="Mouse"
					ToolTipService.BetweenShowDelay="5000"
					ToolTipService.InitialShowDelay="2500"
					Style="{StaticResource ContextMenuStyle}"
					Background="{StaticResource White4}"
					Foreground="Black" 
					PreviewMouseRightButtonUp="DoHandled" 
					Click="printscript_click"/>

			<MenuItem Name="spshowscriptexternally"
					Width="320" 
					Height="30"
					Padding="0 5 0 0"
					Header="Show current script in Editor Window"
					ToolTip="Show script to allow script to be viewed"
					ToolTipService.HorizontalOffset="40"
					ToolTipService.VerticalOffset="15"
					ToolTipService.HasDropShadow="True"
					ToolTipService.Placement="Mouse"
					ToolTipService.BetweenShowDelay="5000"
					ToolTipService.InitialShowDelay="2500"
					Style="{StaticResource ContextMenuStyle}"
					Background="{StaticResource White4}"
					Foreground="Black" 
					PreviewMouseRightButtonUp="DoHandled" 
					Click="ShowExternalscript_click"/>

			<MenuItem Name="spclosenewscript" 
					Width="320"
					Header="Close SQL script panel"
					ToolTip="Close the new SQL script editor in lower pane"
					ToolTipService.HorizontalOffset="40"
					ToolTipService.VerticalOffset="10"
					Style="{StaticResource ContextMenuStyle}"
					Background="{StaticResource Orange3}"
					Foreground="{StaticResource Black0}"
					PreviewMouseRightButtonUp="DoHandled"
					Click="Closenewscript" />

			<MenuItem Name="spdeletescript" 
					Width="300" 
					Height="30"
					Padding="0 5 0 0"
					Header="Delete script"
					ToolTip="Delete the currently selected  script "
					ToolTipService.HorizontalOffset="40"
					ToolTipService.VerticalOffset="10"
					Style="{StaticResource ContextMenuStyle}"
					Background="{StaticResource Red3}"
					Foreground="White"
					PreviewMouseRightButtonUp="DoHandled" 
					Click="DeleteScript"/>


			<!--<MenuItem Name="spsaveclosespeditor"
					Width="320" 
					Height="30"
					Padding="10 8 0 0"
					HorizontalAlignment="Center"
					Header="SAVE new SQL Script"
					ToolTip="SAVE new SQL script and close editor"
					ToolTipService.HorizontalOffset="40"
					ToolTipService.VerticalOffset="15"
					ToolTipService.HasDropShadow="True"
					ToolTipService.Placement="Mouse"
					ToolTipService.BetweenShowDelay="5000"
					ToolTipService.InitialShowDelay="2500"
					Style="{StaticResource ContextMenuStyle}"
					Background="{StaticResource Green8}"
					Foreground="Black" 
					IsEnabled="True" 
					PreviewMouseRightButtonUp="DoHandled"
					Click="SaveNewSprocs" />-->

			<MenuItem Name="spprintnewscript"
						Width="350"
						Height="30"
						BorderBrush="White"
						BorderThickness="1"
						Background="{StaticResource White5}"
						Foreground="{StaticResource Black1}"
						Header="Print new script"
	  					Padding="0 4 0 0"
						Style="{StaticResource ContextMenuStyle}"
						ToolTip="Show Print dialog to allow new SQL script to be printed"
						ToolTipService.HorizontalOffset="40"
						ToolTipService.VerticalOffset="15"
						ToolTipService.HasDropShadow="True"
						ToolTipService.Placement="Mouse"
						ToolTipService.BetweenShowDelay="5000"
						ToolTipService.InitialShowDelay="2500"
						PreviewMouseRightButtonUp="DoHandled" 
						Click="printnewscript_click"/>

			<MenuItem Name="spdiscardclosededitor"
					Width="320" 
					HorizontalAlignment="Center"
					Header="DISCARD new SQL script"
					ToolTip="DISCARD the SQL script in new SQL Script Editor.. Any changes will be lost .. "
					Padding="10 4 0 0"
					ToolTipService.HorizontalOffset="40"
					ToolTipService.VerticalOffset="15"
					ToolTipService.HasDropShadow="True"
					ToolTipService.Placement="Mouse"
					ToolTipService.BetweenShowDelay="5000"
					ToolTipService.InitialShowDelay="2500"
					Style="{StaticResource ContextMenuStyle}"
					Background="{StaticResource Red4}"
					Foreground="White" 
					  Height="30"
					IsEnabled="True" 
					PreviewMouseRightButtonUp="DoHandled"
					Click="CloseCreationGrid" />

			<MenuItem Name="sphideeditpanel"
					Width="320" 
					Height="30"
					Padding="0 5 0 0"
				Header="Hide Script Edit Panel"
					ToolTip="Hide Script Editor Panel and show Data Grid at full size to fit window "
					ToolTipService.HorizontalOffset="40"
					ToolTipService.VerticalOffset="15"
					ToolTipService.HasDropShadow="True"
					ToolTipService.Placement="Mouse"
					ToolTipService.BetweenShowDelay="5000"
					ToolTipService.InitialShowDelay="2500"
					Style="{StaticResource ContextMenuStyle}"
					Background="{StaticResource Orange3}"
					Foreground="{StaticResource Black0}"
					PreviewMouseRightButtonUp="DoHandled" 
					Click="Hidescriptpane_click"/>

			<MenuItem Name="spsetscriptpanelheight" 
					Width="320" 
					Height="30"
					Padding="0 5 0 0"
					Header="Reset Script Viewer position in Window"
					ToolTip="Refit script viewer Panel to fit in lower half of window"
					ToolTipService.HorizontalOffset="40"
					ToolTipService.VerticalOffset="10"
					Style="{StaticResource ContextMenuStyle}"
					Background="{StaticResource Green8}"
					Foreground="Black" 
					PreviewMouseRightButtonUp="DoHandled" 
					Click="ResetScriptPanelSplit"/>

			<MenuItem Name="spshowspscripts"
					Width="320" 
					Height="30"
					Padding="0 5 0 0"
					Header="Show S.Procedure full script contents"
					ToolTip="Show the contents of currently  selected S. Procedure in lower pane"
					ToolTipService.HorizontalOffset="40"
					ToolTipService.VerticalOffset="10"
					Style="{StaticResource ContextMenuStyle}"
					Background="{StaticResource Orange3}"
					Foreground="{StaticResource Black0}"
					PreviewMouseRightButtonUp="DoHandled"
					Click="show_Spscript" />

			<MenuItem Name="spprocessnewscript"
					Width="320" 
					Height="30"
					Padding="0 8 0 0"
					Header="Process/Execute new SQL script"
					ToolTip="Execute the contents of current SQL script in lower pane"
					ToolTipService.HorizontalOffset="40"
					ToolTipService.VerticalOffset="10"
					Style="{StaticResource ContextMenuStyle}"
					Background="{StaticResource Orange3}"
					Foreground="{StaticResource Black0}"
					PreviewMouseRightButtonUp="DoHandled"
					Click="Execnewscript" />

			<!--#endregion SQL Script Editpor-->

			<!--#region RESULTS-->

			<!--<MenuItem Name="closetextresultpanel"
					Width="300" 
					Height="30"
					Padding="0 8 0 0"
					HorizontalAlignment="Center"
					Header="Close currrent Text viewer Panel"
					ToolTip="Close the current Text Results viewer Panel"
					ToolTipService.HorizontalOffset="40"
					ToolTipService.VerticalOffset="10"
					Style="{StaticResource ContextMenuStyle}"
					Background="{StaticResource Green6}"
					Foreground="White" 
					IsEnabled="True" 
					PreviewMouseRightButtonUp="DoHandled"
					Click="CloseTextResultsPanel" />-->


			<MenuItem Name="spsaveresultstofile"
					Style="{StaticResource ContextMenuStyle}"
					Width="300" 
					HorizontalAlignment="Center"
					Header="SAVE results in ListBox to Text File"
					ToolTipService.HorizontalOffset="40"
					ToolTipService.VerticalOffset="10"
					FontSize="16"
					Background="{StaticResource Orange3}"
					Foreground="{StaticResource Black0}"
					FontWeight="SemiBold"
					Height="30"
					Padding="0 5 0 0"
					IsEnabled="True" 
					PreviewMouseRightButtonUp="DoHandled"
					Click="SaveResultsToFile" >
				<MenuItem.ToolTip>
					<Grid Height="50" Width="320" >
						<Border BorderBrush="Red" BorderThickness="2">
							<TextBlock x:Name="tiptext" TextWrapping="Wrap"
										   FontSize="18"
										   Text="SAVE the Results to a text file in [DEBUG\USERSDATA\ListboxResults.txt]"/>
						</Border>
					</Grid>
				</MenuItem.ToolTip>
			</MenuItem>

			<MenuItem Name="spprintesultspanel" Width="300" 
					ToolTip="Print"
					ToolTipService.HorizontalOffset="40"
					ToolTipService.VerticalOffset="10"
					Style="{StaticResource ContextMenuStyle}"
					FontSize="16"
					  FontWeight="DemiBold"
					Height="30"
					Padding="0 5 0 0"
					Background="{StaticResource Orange3}"
					Foreground="{StaticResource Black0}"
					PreviewMouseRightButtonUp="DoHandled"
					Click="PrintResultPanel" >
				<MenuItem.Header>
					<TextBlock Text="Print Contents of Results Panel" 
							   Width="300"/>
				</MenuItem.Header>
			</MenuItem>

			<MenuItem Name="spcloseresultpanel"
					Width="300" 
					Height="30"
					Padding="0 4 0 0"
					HorizontalAlignment="Center"
					Header="Close Current Results Panel"
					ToolTip="Close the current Execution Results Panel"
					ToolTipService.HorizontalOffset="40"
					ToolTipService.VerticalOffset="10"
					Style="{StaticResource ContextMenuStyle}"
					Background="{StaticResource Red4}"
					Foreground="{StaticResource Yellow0}" 
					IsEnabled="True" 
					PreviewMouseRightButtonUp="DoHandled"
					Click="CloseResultsPanel" />

			<MenuItem Name="spcloseresultspanel" Width="300" 
					ToolTip="Switch lower panel to S.Procedure script viewer"
					ToolTipService.HorizontalOffset="40"
					ToolTipService.VerticalOffset="10"
					Style="{StaticResource ContextMenuStyle}"
					FontSize="16"
					  FontWeight="DemiBold"
					Height="30"
					Padding="0 5 0 0"
				Background="{StaticResource Orange3}"
					Foreground="{StaticResource Black0}"
					PreviewMouseRightButtonUp="DoHandled"
					Click="HideResultsPanel" >
				<MenuItem.Header>
					<TextBlock Text="Hide Execution Results Panel" 
							   Width="300"/>
				</MenuItem.Header>
			</MenuItem>

			<MenuItem 
					Width="400" 
					Height="2" IsHitTestVisible="false"
					Background="{StaticResource White0}" 
					Foreground="White" IsEnabled="False" 
 					Style="{StaticResource ContextMenuStyle}"/>

			<MenuItem Name="spclosefilepanel" 
					Width="300" 
					HorizontalAlignment="Center"
					Header="Close Quick Viewer"
					ToolTipService.HorizontalOffset="40"
					ToolTipService.VerticalOffset="10"
					Style="{StaticResource ContextMenuStyle}"
					FontSize="16"
					Background="{StaticResource Orange3}"
					Foreground="{StaticResource Black0}"
					FontWeight="SemiBold"
					Height="30"
					Padding="0 5 0 0"
					IsEnabled="True" 
					PreviewMouseRightButtonUp="DoHandled"
					Click="CloseFileViewer" >
			</MenuItem>

			<MenuItem Name="spprintfilepanel"
					Width="300" 
					HorizontalAlignment="Center"
					Header="Print Text in File Viewer"
					ToolTipService.HorizontalOffset="40"
					ToolTipService.VerticalOffset="10"
					Style="{StaticResource ContextMenuStyle}"
					FontSize="16"
					Background="{StaticResource Orange3}"
					Foreground="{StaticResource Black0}"
					FontWeight="SemiBold"
					Height="30"
					Padding="0 5 0 0"
					IsEnabled="True" 
					PreviewMouseRightButtonUp="DoHandled"
					Click="PrintFileViewer" />

			<!--#end region RESULTS-->

			<MenuItem Name="spsmallwin"
					Width="300" 
					Height="30"
					Padding="0 5 0 0"
					Header="Set Window size to Small"
					ToolTip="Set Window size to smallest reasonable size"
					ToolTipService.HorizontalOffset="40"
					ToolTipService.VerticalOffset="10"
					Background="{StaticResource Purple6}" 
					Foreground="{StaticResource White0}"
					Style="{StaticResource ContextMenuStyle}"
					Click="Showsmallwin"
					PreviewMouseRightButtonUp="DoHandled" />

			<MenuItem Name="spmediumwin" 
					Width="300" 				  
					Height="30"
					Padding="0 5 0 0"
					Header="Set Window size to Medium"
					ToolTip="Set Window size to medium reasonable size"
					ToolTipService.HorizontalOffset="40"
					ToolTipService.VerticalOffset="10"
					Background="{StaticResource Purple6}" 
					Foreground="{StaticResource White0}"
					Style="{StaticResource ContextMenuStyle}"
					Click="Showmediumwin"
					PreviewMouseRightButtonUp="DoHandled" />

			<MenuItem Name="splargewin" 
					Width="300"
					Height="30"
					Padding="0 5 0 0"
					Header="Set Window size to Large"
					ToolTip="Set Window size to a large size"
					ToolTipService.HorizontalOffset="40"
					ToolTipService.VerticalOffset="10"
					Background="{StaticResource Purple6}" 
					Foreground="{StaticResource White0}"
					Style="{StaticResource ContextMenuStyle}"
					Click="Showlargewin"
					PreviewMouseRightButtonUp="DoHandled" />

			<MenuItem Name="fulwinheight" 
					Width="300"
					Height="30"
					Padding="0 5 0 0"
					Header="Toggle Window ^/v Max/Normal"
					ToolTip="Set Window height to Screen height"
					ToolTipService.HorizontalOffset="40"
					ToolTipService.VerticalOffset="10"
					Background="{StaticResource Cyan5}" 
					Foreground="{StaticResource White0}"
					Style="{StaticResource ContextMenuStyle}"
					Click="TriggerFullHeight"
					PreviewMouseRightButtonUp="DoHandled" />

			<MenuItem 
					Width="400" 
					Height="2" IsHitTestVisible="false"
					Background="{StaticResource White0}" 
					Foreground="White" IsEnabled="False" 
 					Style="{StaticResource ContextMenuStyle}"/>

			<MenuItem Name="topmost" 
					  Width="300" 
					Height="30"
					Padding="0 5 0 0"
					  Header="Disable Window TopMost status"
					  ToolTip="Stop other Windows from covering this window"
						ToolTipService.HorizontalOffset="40"
						ToolTipService.VerticalOffset="10"
					  ToolTipService.InitialShowDelay="2000"
					Background="{StaticResource Cyan5}"
					  Foreground="{StaticResource White0}"
					  Style="{StaticResource ContextMenuStyle}" 
					  Click="ToggleTopmost"
					PreviewMouseRightButtonUp="DoHandled" />

			<MenuItem Name="nontopmost" 
					  Width="300"  
					Height="30"
					Padding="0 5 0 0"
					  Header="Enable Window TopMost status"
					  ToolTip="Allow other Windows to cover this window"
						ToolTipService.HorizontalOffset="40"
						ToolTipService.VerticalOffset="10"
						Foreground="{StaticResource White0}"
						Background="{StaticResource Blue3}" 
					  Style="{StaticResource ContextMenuStyle}" 
					  Click="ToggleTopmost"
					PreviewMouseRightButtonUp="DoHandled" >
			</MenuItem>

			<!--//^^^^^^^^^^^^^^^^^^^end Topmost setup^^^^^^^^^^^^^^^^^^^^^^^^^^^^//-->
			<MenuItem 
					Width="400" 
					Height="2" IsHitTestVisible="false"
					Background="{StaticResource White0}" 
					Foreground="White" IsEnabled="False" 
 					Style="{StaticResource ContextMenuStyle}"/>

			<MenuItem Name="setautosplitterposition"
					  Width="300"  
					Height="30"
					Padding="0 5 0 0"
					  Header="Allow splitter bar to reset it's position"
					  ToolTip="Set the Splitter bar to return to it's previous position when Sql Table Data Editing panel is Closed"
						ToolTipService.HorizontalOffset="40"
						ToolTipService.VerticalOffset="10"
						Background="{StaticResource Yellow1}" 
						Foreground="{StaticResource Black0}"
					  Style="{StaticResource ContextMenuStyle}" 
					  Click="Togglesplitterreset"					  
						PreviewMouseRightButtonUp="DoHandled" />

			<MenuItem Name="disableautosplitter" 
					  Width="300"  
					Height="30"
					Padding="0 5 0 0"
					  Header="Stop Splitter bar resetting it's position"
					  ToolTip="Set the Splitter bar so will remain in it's current position when Sql Table Data Editing panel is Closed"
						ToolTipService.HorizontalOffset="40"
						ToolTipService.VerticalOffset="10"
						Background="{StaticResource Black0}" 
						Foreground="{StaticResource Yellow1}"
					  Style="{StaticResource ContextMenuStyle }"
					  Click="Togglesplitterreset"
					PreviewMouseRightButtonUp="DoHandled" />
			<!--#endregion Context menu Generic items-->

		</ContextMenu>

		<!--#endregion SProcs context menu-->

		<!--#endregion SP Context Menu-->

		<!--#region Datagrid ContextMenu-->

		<ContextMenu x:Key="DgridContextmenu" 
				Width="300" 
				HorizontalOffset="-120"
				VerticalOffset="10"
				Background="White"
				Visibility="Hidden">
			<!--// ALWAYS USE THIS to remove Annoying Image panel at left-->

			<ContextMenu.Style>
				<Style TargetType="{x:Type ContextMenu}">
					<Setter Property="ItemsPanel" Value="{StaticResource SPNoImageMenu}" />
				</Style>
			</ContextMenu.Style>

			<MenuItem Name="dgshowsprocs"
					  Width="300" 
					Style="{StaticResource ContextMenuStyle}"
					Height="30"
					Padding="0 5 0 0"
					HorizontalAlignment="Center"
					  Header="Switch to Stored Procedures View" 
					ToolTip="Show S. Procedures list and Execution methods in upper pane"
					ToolTipService.HorizontalOffset="40"
					ToolTipService.VerticalOffset="10"
					Background="{StaticResource Red4}"
					Foreground="White" 
					IsEnabled="True" 
					PreviewMouseRightButtonUp="DoHandled"
					Click="show_Sprocs" 
					>
			</MenuItem>

			<!--#region table split options-->

			<MenuItem Name="dgshowfulldatagrid" 
					Width="300" 
					Height="30"
					Padding="0 5 0 0"
					Header="Show Sql Table at  full height"
					ToolTip="Position Splitter so that Sql Table Editor pane fits correctly"
					ToolTipService.HorizontalOffset="40"
					ToolTipService.VerticalOffset="10"
					Style="{StaticResource ContextMenuStyle}"
					Background="{StaticResource Orange3}"
					Foreground="{StaticResource Black0}"
					PreviewMouseRightButtonUp="DoHandled" 
					Click="ExpandSqlDataGrid"/>

			<MenuItem Name="dghideeditpanel"
					Width="300" 
					Height="30"
					Padding="0 5 0 0"
					Header="Hide Table Edit Panel"
					ToolTip="Hide Edit Panel and show Data Grid at full sizeto fit window "
					ToolTipService.HorizontalOffset="40"
					ToolTipService.VerticalOffset="10"
					Style="{StaticResource ContextMenuStyle}"
					Background="{StaticResource Orange3}"
					Foreground="{StaticResource Black0}"
					PreviewMouseRightButtonUp="DoHandled" 
					Click="Hidepane_click"/>

			<MenuItem Name="dgseteditpanelheight" 
					Width="300" 
					Height="30"
					Padding="0 5 0 0"
					Header="Reset Edit Panel Height"
					ToolTip="Show full Edit Panel and resize Sql Table grid to fit Window correctly"
					ToolTipService.HorizontalOffset="40"
					ToolTipService.VerticalOffset="10"
					Style="{StaticResource ContextMenuStyle}"
					Background="{StaticResource Orange3}"
					Foreground="Black"
					PreviewMouseRightButtonUp="DoHandled" 
					Click="ResetPanelSplit"/>

			<!--#endregion table split options-->

			<MenuItem Name="dgprintdatafile"
					Width="300" 
					Height="30"
					Padding="0 5 0 0"
					Header="print content of data file panel"
					ToolTip="Print contents oof the file displayed in the lower pane "
					ToolTipService.HorizontalOffset="40"
					ToolTipService.VerticalOffset="10"
					Style="{StaticResource ContextMenuStyle}"
					Background="{StaticResource Orange3}"
					Foreground="{StaticResource Black0}"
					PreviewMouseRightButtonUp="DoHandled"
					Click="printscript_click" />

			<!--<MenuItem Name="dgclosenewscript" 
					BorderBrush="Black" BorderThickness="0 5 0 0"
					Width="300"
					Height="30"
					Padding="0 3 0 0"
					Header="Close SQL script panel"
					ToolTip="Close the SQL script editor in lower pane"
					ToolTipService.HorizontalOffset="40"
					ToolTipService.VerticalOffset="10"
					Style="{StaticResource ContextMenuStyle}"
					Background="{StaticResource Orange3}"
					Foreground="{StaticResource Black0}"
					PreviewMouseRightButtonUp="DoHandled"
					Click="Closenewscript" />-->

			<!--#endregion Script creation items-->

			<!--#region Results options-->
			<MenuItem Name="dgsaveresultstofile"
					Width="300" 
					HorizontalAlignment="Center"
					Header="SAVE results to Text File"
					ToolTipService.HorizontalOffset="40"
					ToolTipService.VerticalOffset="10"
					Style="{StaticResource ContextMenuStyle}"
					FontSize="16"
					Background="{StaticResource Orange3}"
					Foreground="{StaticResource Black0}"
					FontWeight="SemiBold"
					Height="30"
					Padding="0 5 0 0"
					IsEnabled="True" 
					PreviewMouseRightButtonUp="DoHandled"
					Click="SaveResultsToFile" >
				<MenuItem.ToolTip>
					<Grid Height="50" Width="320" >
						<Border BorderBrush="Red" BorderThickness="2">
							<TextBlock x:Name="tiptext2" TextWrapping="Wrap"
										   FontSize="18"
										   Text="SAVE the Results to a text file in [DEBUG\USERSDATA\ListboxResults.txt]"/>
						</Border>
					</Grid>
				</MenuItem.ToolTip>
			</MenuItem>

			<MenuItem Name="dgcloseresultpanel"
					Width="300" 
					HorizontalAlignment="Center"
					Header="Close Current Results Panel"
					ToolTip="Close the REsults Panel Display"
					ToolTipService.HorizontalOffset="40"
					ToolTipService.VerticalOffset="10"
					Style="{StaticResource ContextMenuStyle}"
					Background="{StaticResource Red4}"
					Foreground="Black" 
					Height="30"
					Padding="0 10 0 0"
					IsEnabled="True" 
					PreviewMouseRightButtonUp="DoHandled"
					Click="CloseResultsPanel" />


			<MenuItem Name="dgcloseresultspanel" Width="300" 
					ToolTip="Close results panel viewer"
					ToolTipService.HorizontalOffset="40"
					ToolTipService.VerticalOffset="10"
					Style="{StaticResource ContextMenuStyle}"
					FontSize="16"
					  FontWeight="DemiBold"
					Height="30"
					Padding="0 5 0 0"
				Background="{StaticResource Red3}"
					Foreground="{StaticResource Yellow0}"
					PreviewMouseRightButtonUp="DoHandled"
					Click="HideResultsPanel" >
				<MenuItem.Header>
					<TextBlock Text="Close Results Panel" 
							   Width="300"/>
				</MenuItem.Header>
			</MenuItem>

			<!--#endregion Results options-->

			<!--#region local display options-->


			<!--#endregion local display options-->

			<!--#region general options-->

			<MenuItem Name="dgsetautosplitterposition"
					  Width="300"  
					Height="30"
					Padding="0 5 0 0"
					  Header="Allow splitter bar to reset it's position"
					  ToolTip="Set the Splitter bar to return to it's previous position when Sql Table Data Editing panel is Closed"
						ToolTipService.HorizontalOffset="40"
						ToolTipService.VerticalOffset="10"
						Background="{StaticResource Yellow1}" 
						Foreground="{StaticResource Black0}"
					  Style="{StaticResource ContextMenuStyle}" 
					  Click="Togglesplitterreset"					  
						PreviewMouseRightButtonUp="DoHandled" />

			<MenuItem Name="dgdisableautosplitter" 
					  Width="300"  
					Height="30"
					Padding="0 5 0 0"
					  Header="Stop Splitter bar resetting it's position"
					  ToolTip="Set the Splitter bar so will remain in it's current position when Sql Table Data Editing panel is Closed"
						ToolTipService.HorizontalOffset="40"
						ToolTipService.VerticalOffset="10"
						Background="{StaticResource Black0}" 
						Foreground="{StaticResource Yellow1}"
					  Style="{StaticResource ContextMenuStyle }"
					  Click="Togglesplitterreset"
					PreviewMouseRightButtonUp="DoHandled" />

			<!--#endregion general options-->

			<!--#region generic resizeing-->

			<MenuItem Name="dgsmallwin"
					BorderBrush="Black" BorderThickness="0 2 0 0"
					Width="300" 
					Height="30"
					Padding="0 5 0 0"
					Header="Set Window size to Small"
					ToolTip="Set Window size to smallest reasonable size"
					ToolTipService.HorizontalOffset="40"
					ToolTipService.VerticalOffset="10"
					Background="{StaticResource Purple6}" 
					Foreground="{StaticResource White0}"
					Style="{StaticResource ContextMenuStyle}"
					Click="Showsmallwin"
					PreviewMouseRightButtonUp="DoHandled" />

			<MenuItem Name="dgmediumwin" 
					Width="300" 
					Height="30"
					BorderThickness="0 0 0 0"
					Padding="0 5 0 0"
					Header="Set Window size to Medium"
					ToolTip="Set Window size to medium reasonable size"
					ToolTipService.HorizontalOffset="40"
					ToolTipService.VerticalOffset="10"
					Background="{StaticResource Purple6}" 
					Foreground="{StaticResource White0}"
					Style="{StaticResource ContextMenuStyle}"
					Click="Showmediumwin"
					PreviewMouseRightButtonUp="DoHandled" />

			<MenuItem Name="dglargewin" 
					Width="300"
					Height="30"
					BorderBrush="Black" BorderThickness="0 0 0 2"
					Padding="0 5 0 0"
					Header="Set Window size to Large"
					ToolTip="Set Window size to a large size"
					ToolTipService.HorizontalOffset="40"
					ToolTipService.VerticalOffset="10"
					Background="{StaticResource Purple6}" 
					Foreground="{StaticResource White0}"
					Style="{StaticResource ContextMenuStyle}"
					Click="Showlargewin"
					PreviewMouseRightButtonUp="DoHandled" />

			<!--#endregion generic resizeing-->

			<MenuItem Name="dgtopmost" 
					Background="{StaticResource Blue2}" 
					Foreground="{StaticResource White0}"
					  Width="300" 
					Height="30"
					Padding="0 2 0 0"
					  Header="Disable Window TopMost status"
					  ToolTip="Stop other Windows from covering this window"
						ToolTipService.HorizontalOffset="40"
						ToolTipService.VerticalOffset="10"
					  ToolTipService.InitialShowDelay="2000"
					  Style="{StaticResource ContextMenuStyle}" 
					  Click="ToggleTopmost"
					PreviewMouseRightButtonUp="DoHandled" />

			<MenuItem Name="dgnontopmost" 
					Background="{StaticResource Blue2}" 
					Foreground="{StaticResource White0}"
					  Width="300"  
					Height="30"
					Padding="0 10 0 0"
					  Header="Enable Window TopMost status"
					  ToolTip="Allow other Windows to cover this window"
						ToolTipService.HorizontalOffset="40"
						ToolTipService.VerticalOffset="10"
					  Style="{StaticResource ContextMenuStyle}" 
					  Click="ToggleTopmost"
					PreviewMouseRightButtonUp="DoHandled" >
			</MenuItem>

			<MenuItem Name="dgfullwinheight" 
					Background="{StaticResource Green2}" 
					Foreground="{StaticResource White0}"
					Width="300"
					Height="30"
					Padding="0 5 0 0"
					Header="Toggle Window ^/v Max/Normal"
					ToolTip="Set Window height to Screen height"
					ToolTipService.HorizontalOffset="40"
					ToolTipService.VerticalOffset="10"
					Style="{StaticResource ContextMenuStyle}"
					Click="TriggerFullHeight"
					PreviewMouseRightButtonUp="DoHandled" />

		</ContextMenu>

		<!--#endregion Datagrid ContextMenu-->

	</Window.Resources>

	<!--//************************************************************************************//-->
	<!--// Start of XAML code-->
	<!--//************************************************************************************//-->

	<Grid x:Name="sprocsContainerGrid"
		  Background="{StaticResource Black2}" Margin="0,0,5,1" VerticalAlignment="Stretch">

		<!--#region entire window setup-->
		<Grid.RowDefinitions>
			<RowDefinition Height="70" />
			<RowDefinition x:Name="DataArea" Height="*" />
			<RowDefinition Height="205" />
		</Grid.RowDefinitions>

		<!--// 2 columns  for top row-->
		<Grid.ColumnDefinitions>
			<ColumnDefinition x:Name="col1" Width="*" />
			<ColumnDefinition x:Name="col2" Width="*" />
		</Grid.ColumnDefinitions>

		<!--// Contents of Row 0 of main outer grid-->

		<!--#region Hidden textblock !!-->
		<TextBlock x:Name="SPHeaderblock" Grid.Row="0" 
				   Grid.Column="0" Height="1" Width="200" Background="White"
				Foreground="Black" Visibility="Collapsed" Text="" />
		<!--#endregion Hidden textblock !!-->

		<!--#endregion  total window setup-->

		<!--*******************************-->
		<!--#region main window MENU-->
		<!--*******************************-->

		<Menu x:Name="MainWinmenu"
					Grid.Row="0" Grid.Column="0"
					Grid.ColumnSpan="4"
					Background="Transparent"
					Foreground="White"
					BorderBrush="White"
					FontSize="16"
					HorizontalAlignment="Left" 
					MaxWidth="550"
					Margin="0,3,0,35"
					Height="40"
					Width="480" >

			<!--// ALL WORKING GREAT 13/1/2023-->

			<!--#region Menu #1 - File-->

			<MenuItem x:Name="Filemenu" Header="File" 
					BorderBrush="Transparent"
					BorderThickness="1"
					FontWeight="DemiBold"
					  Foreground="{StaticResource Yellow2}"
					HorizontalContentAlignment="Center"
					Width="60" 
					MouseEnter="Menu_MouseEnter"
					Height="30" >
				<!--<MenuItem.Style>
					<Style TargetType="{x:Type MenuItem}">
						<Setter Property="ItemsPanel" Value="{StaticResource MainNoImageMenu}" />
					</Style>
				</MenuItem.Style>-->

				<MenuItem  x:Name="CloseWin"  Header="Close Window" 
							BorderBrush="White"
							BorderThickness="1"
							Foreground="Yellow"	
							HorizontalAlignment="Center"	
							HorizontalContentAlignment="Center"
							ToolTip="Close this window down...."
							Width="260"
							Height="30"
							Click="Close_Click">
				</MenuItem>

				<MenuItem  x:Name="OpenFile" 
						   BorderBrush="White"
						   BorderThickness="1"
							Foreground="Yellow"	
							Header="Open File in Editor" 
							ToolTip="Load any type of file into Editor...."
							Width="260"
							Height="30"
							Click="OpenDataFile">

					<MenuItem.Resources>
						<Style TargetType="Popup">
							<Setter Property="Width" Value="500"/>
						</Style>
					</MenuItem.Resources>
				</MenuItem>

				<MenuItem  x:Name="About" 
						   BorderBrush="White"
						   BorderThickness="1"
							Foreground="Yellow"
							Header="About S.Procs/DataGrid View" 
							ToolTip="Show full information about all of this window's extensive functionality...."
							Width="260"
							Height="30"
							Click="About_Click">
					<MenuItem.Resources>
						<Style TargetType="Popup">
							<Setter Property="Width" Value="500"/>
						</Style>
					</MenuItem.Resources>

				</MenuItem>


			</MenuItem>
			<!--#endregion #1 File-->

			<!--#region Menu #2 - Views-->

			<MenuItem x:Name="viewsmenu" 
							Foreground="{StaticResource Blue7}"
							BorderBrush="White"
							FontWeight="DemiBold"
							BorderThickness="1"						
							Header="View" 
							HorizontalContentAlignment="Center"
							Margin="0 0 0 0"
							MouseEnter="Menu_MouseEnter"
							Width="80" 
							Height="30"
							Click="SphMenu_ViewsMenuOpening">
				<MenuItem.Style>
					<Style TargetType="{x:Type MenuItem}">
						<Setter Property="ItemsPanel" Value="{StaticResource MainNoImageMenu}" />
					</Style>
				</MenuItem.Style>

				<!--// Sub menu items, foreground works !!-->
				<MenuItem  x:Name="ShowSpmenu" 
					  Background="{StaticResource Red5}"
						   BorderBrush="White"
						   BorderThickness="1"
							Foreground="{StaticResource White1}"
							Header="Switch to S.Procedure View" 
							MouseEnter="ShowpSp_MouseEnter"
							MouseLeave="ShowSp_MouseLeave"
							ToolTip="Bring the Stored Procedures panels to the front...."
						   Width="280"
							Height="30"
						    Click="show_Sprocs"/>

				<MenuItem  x:Name="ShowDgmenu" 
					  Background="{StaticResource Red5}"
						   BorderBrush="White"
						   BorderThickness="1"
							Foreground="{StaticResource White0}"
							Header="Switch to SQL DataGrid View" 
							MouseEnter="ShowpDg_MouseEnter"
							MouseLeave="ShowDg_MouseLeave"
							ToolTip="Bring the SQL Tables Access system panels to the front...."
						   Width="280"
							Height="30"
						   Click="show_DataGrid"/>

				<MenuItem  x:Name="ReloadSProcs" 
								BorderBrush="White"
								BorderThickness="1"
								Foreground="{StaticResource Yellow1}"
								Header="Reload the list of S.Procedures" 
								Width="280"
								Height="30"
								Click="ReloadProcs_Click"/>

				<MenuItem  x:Name="ShowSavedData" 
								BorderBrush="White"
								BorderThickness="1"
								Foreground="{StaticResource White0}"
								Header="View a Saved Data Text File" 
								Width="280"
								Height="30"
								Click="ShowDataFiles_Click"/>

				<MenuItem  x:Name="CloseSavedData" 
								BorderBrush="White"
								BorderThickness="1"
								Foreground="{StaticResource White0}"
								Header="Close Saved Data File (Discards data)" 
								Width="280"
								Height="30"
								Click="CloseDataFiles_Click"/>

				<!--<MenuItem  x:Name="ShowSpEditor" 
						   BorderBrush="White"
						   BorderThickness="1"
							Foreground="{StaticResource White1}"
							Header="Load/Show new SQL script" 
							MouseEnter="ShowpSp_MouseEnter"
							MouseLeave="ShowSp_MouseLeave"
							ToolTip="Load new script and bring panel to the front...."
						   Width="280"
							Height="30"
						    Click="LoadShowScript"/>-->

				<MenuItem  x:Name="SaveDataFile" 
								BorderBrush="White"
								BorderThickness="1"
								Foreground="{StaticResource White0}"
								Header="Save Data File and close panel" 
								Width="280"
								Height="30"
								Click="SaveDataFiles_Click"/>
			</MenuItem>

			<!--#endregion #2 Views-->

			<!--#region scripts-->
			<MenuItem x:Name="scriptsmenu" 
							Foreground="{StaticResource Purple6}"
							FontWeight="DemiBold"
							BorderBrush="White"
							BorderThickness="1"						
							Header="SQL Scripts" 
							HorizontalContentAlignment="Center"
							Margin="0 0 0 0"
					MouseEnter="Menu_MouseEnter"
							Width="120" 
							Height="30"
							Click="SphMenus_ScriptsMenuOpening">
				<MenuItem.Style>
					<Style TargetType="{x:Type MenuItem}">
						<Setter Property="ItemsPanel" Value="{StaticResource MainNoImageMenu}" />
					</Style>
				</MenuItem.Style>

				<MenuItem  x:Name="EditExistingSqlScript" 
						   BorderBrush="White"
						   BorderThickness="1"
							Foreground="{StaticResource White0}"
							Header="Open current SQL Script in Editor" 
							MouseEnter="ShowpDg_MouseEnter"
							MouseLeave="ShowDg_MouseLeave"
							ToolTip="Load existing SQL script into Editor that allows you to Edit/Execute SQL Script ........"
						   Width="350"
							Height="30"
						   Click="EditExistingScript">
				</MenuItem>

				<MenuItem Name="CreateNewScript"
					Width="350" 
					Height="30"
					Padding="0 5 0 0"
					BorderBrush="White"
					Header="Load NEW Stored Procedure in Editor Window"
					ToolTip="Load Script Editor Window to allow a new script to be created and saved"
					ToolTipService.HorizontalOffset="40"
					ToolTipService.VerticalOffset="15"
					ToolTipService.HasDropShadow="True"
					ToolTipService.Placement="Mouse"
					ToolTipService.BetweenShowDelay="5000"
					ToolTipService.InitialShowDelay="2500"
					Foreground="{StaticResource White0}"
					PreviewMouseRightButtonUp="DoHandled" 
					Click="ShownewscriptEditor_click"/>

			</MenuItem>

			<!--#endregion scripts-->

			<!--#region Menu #4 - Options-->

			<MenuItem x:Name="optsmenu" 
							Foreground="{StaticResource Red6}"
							BorderBrush="White"
							FontWeight="DemiBold"
							BorderThickness="1"
							Header="Options"
							HorizontalContentAlignment="Center"
							MouseEnter="Menu_MouseEnter"
							Width="80" 
							Height="30">
				<MenuItem.Style>
					<Style TargetType="{x:Type MenuItem}">
						<Setter Property="ItemsPanel" Value="{StaticResource MainNoImageMenu}" />
					</Style>
				</MenuItem.Style>

				<MenuItem  x:Name="ShowGridFullheight" 
								BorderBrush="White"
								BorderThickness="1"
								Foreground="{StaticResource White1}"
								Header="Expand Data grid to fill window" 
								Width="350"
								Height="30"
								Click="ExpandGridHeight_Click"/>

				<MenuItem  x:Name="ResetGridheight" 
								BorderBrush="White"
								BorderThickness="1"
								Foreground="{StaticResource White1}"
								Header="Reset Data grid to show Edit Panel" 
								Width="350"
								Height="30"
								Click="ExpandGridHeight_Click"/>

				<MenuItem  x:Name="UpdateRecord" 
							BorderBrush="White"
							BorderThickness="1"
							Foreground="{StaticResource White1}"
							Header="Update current record" 
							Width="350"
							Height="30"
							Click="ResetEditPanelHeight"/>

				<MenuItem Name="MainPrintScript"
							Width="350"
							Height="30"
							BorderBrush="White"
							BorderThickness="1"
							Foreground="{StaticResource White1}"
							Header="Print currently selected Script"
							ToolTip="Show Print dialog to allow current SQL script to be printed"
							Click="printscript_click"/>

				<MenuItem Name="PrintTableContents"
							Width="350"
							Height="30"
							BorderBrush="White"
							BorderThickness="1"
							Foreground="{StaticResource White1}"
							Header="Print contents of Datagrid"
							ToolTip="Show Print dialog to allow current SQL script to be printed"
							Click="Printtablecontents_click"/>

				<MenuItem Name="PrintNewScript"
						Width="350"
						Height="30"
						BorderBrush="White"
						BorderThickness="1"
						Foreground="{StaticResource White1}"
						Header="Print new script"
						ToolTip="Show Print dialog to allow new SQL script to be printed"
						ToolTipService.HorizontalOffset="40"
						ToolTipService.VerticalOffset="15"
						ToolTipService.HasDropShadow="True"
						ToolTipService.Placement="Mouse"
						ToolTipService.BetweenShowDelay="5000"
						ToolTipService.InitialShowDelay="2500"
						PreviewMouseRightButtonUp="DoHandled" 
						Click="printnewscript_click"/>

				<MenuItem  x:Name="ShowSPSchema" 
								BorderBrush="White"
								BorderThickness="1"
								Foreground="{StaticResource White0}"
								Header="Show current SQL Table's Schema" 
								Width="350"
								Height="30"
								Click="showSPSchema_Click"/>

			</MenuItem>
			<!--#endregion #3 Options-->

			<!--#region #5 Help-->

			<MenuItem x:Name="Helpmenu" 
					Foreground="{StaticResource Green5}"
					FontWeight="DemiBold"
					BorderBrush="White"
					BorderThickness="1"
					HorizontalContentAlignment="Center"
					Header="Help"
					MouseEnter="Menu_MouseEnter"
					Margin="10 0 0 0"
					Width="80" 
					Height="30">
				<MenuItem.Style>
					<Style TargetType="{x:Type MenuItem}">
						<Setter Property="ItemsPanel" Value="{StaticResource MainNoImageMenu}" />
					</Style>
				</MenuItem.Style>

				<MenuItem  x:Name="OverallInfo" 
								BorderBrush="White"
								BorderThickness="1"
								Foreground="{StaticResource White1}"
								Header="Overview of this windows functionality" 
								Width="350"
								Height="30"
								Click="Overall_Click"/>

				<MenuItem  x:Name="UsingSqlTable" 
								BorderBrush="White"
								BorderThickness="1"
								Foreground="{StaticResource White1}"
								Header="Using the SQL Table Access System" 
								Width="350"
								Height="30"
								Click="UsingSQLPanel"/>

				<MenuItem  x:Name="UsingSprocs" 
								BorderBrush="White"
								BorderThickness="1"
								Foreground="{StaticResource White1}"
								Header="Using the S.Procedures Access System" 
								Width="350"
								Height="30"
								Click="UsingSprocsPanel"/>

			</MenuItem>

			<!--#endregion #5 help-->

		</Menu>
		<!--#endregion main window menu-->

		<!--#region HeaderBlocks Height = 60-->

		<TextBlock   x:Name="ListTitle" Grid.Row="0" Grid.Column="0" 
						Height="30"
						Width="Auto" 
						Background="{StaticResource Red4}"
						Foreground="{StaticResource White0}" 
						TextAlignment="Center"
						Margin ="0 30 0 0" 
						FontSize="16"
						Padding="0 5 0 0" 
						Text="All Stored Procedures" />

		<TextBlock x:Name="ExecTitle" Grid.Row="0" Grid.Column="1" 
						Height="30"
						Width="Auto" 
						Background="{StaticResource Red4}"
						Foreground="{StaticResource White0}" 
						FontSize="16"
						TextAlignment="Center" 
						Padding="0 5 0 0"
						Margin ="0 30 0 0" 
						Text="Available Execution Modes" />

		<TextBlock x:Name="DgridInfo" Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="2"
						Height="30"
						Background="{StaticResource Red5}" 
						Visibility="Visible" 
						Foreground="{StaticResource White0}"
						Margin ="0 30 0 0" 
						TextAlignment="Center" 
						Padding="0 5 0 0" 
						Text="" />

		<!--#endregion HeaderBlocks-->

		<!--// Now we use an iNnER grid to yhandle the working area ONLY-->
		<!--//Holds  the Entire windows ACTIVE contents-->

		<!--//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$//-->
		<!--#region FullDataContainerGrid-->
		<!--DO NOT CLOSE THIS R EGION  -->
		<!--//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$//-->

		<Grid x:Name="SPFullDataContainerGrid" Grid.Row="1" 
				Background="{StaticResource Black1}"
				Tag="SPFullDataContainerGrid"
				Width="{Binding ActualWidth, ElementName=sprocsContainerGrid,
					Converter={StaticResource ReduceByParamValue},ConverterParameter=5}"
				Grid.ColumnSpan="2" 
				Margin="2,0,1,0"
				Height="{Binding ActualHeight, ElementName=sprocsContainerGrid,
					Converter={StaticResource ReduceByParamValue} ,ConverterParameter=60}"
				VerticalAlignment="Top"
				Visibility="Visible">

			<!--#region SQL data view grid setup only-->

			<Grid.RowDefinitions>
				<RowDefinition x:Name="upperrow" Height="*" />
				<RowDefinition Height="22" />
				<RowDefinition  x:Name="lowerrow" Height="*" />
			</Grid.RowDefinitions>

			<Grid.ColumnDefinitions>
				<ColumnDefinition x:Name="col11" Width="2*" />
				<ColumnDefinition x:Name="col12" Width="2*" />
			</Grid.ColumnDefinitions>

			<!--#endregion grid setup-->

			<!--#region SQL DataGrid-->

			<DataGrid x:Name="SPDatagrid" Grid.Row="0"
								AutoGenerateColumns="false"
								Background="{StaticResource Cyan5}"
								CellStyle="{StaticResource DataGridStyleBlue}"
								CellEditEnding="SPDatagrid_CellEditEnding"
								 FontSize="{Binding ScrollViewerFontSize, ElementName=MainWindow}"
								Foreground="{StaticResource Red2}"
								GotFocus="SPDatagrid_GotFocus"
								Grid.Column="0" 
								Grid.RowSpan="1"
								Grid.ColumnSpan="2" 
								HorizontalAlignment="Stretch"								
								IsEnabled="True"
								IsHitTestVisible="True"
								IsReadOnly="true"
								Loaded="SPDatagrid_Loaded"			
								PreviewKeyDown="SProcsViewer_KeyDown"
								Margin="2,0,3,0" 
								PreviewMouseLeftButtonDown="SPDatagrid_PreviewMouseLeftButtonDown"
								PreviewMouseLeftButtonUp="SPDatagrid_PreviewMouseLeftButtonUp"
								PreviewMouseRightButtonDown="SphMenus_ExecShowDgridContextMenu"
								PreviewMouseRightButtonUp="DoHandled" 
								PreviewMouseDoubleClick="edit_dgItem"
								RowEditEnding="dg_RowEditEnding"
								RowHeight="25"
								SelectionMode="Single"
								SelectionChanged="SPDatagrid_SelectionChanged" 
							   ToolTipService.Placement="Mouse"
							   ToolTipService.BetweenShowDelay="2000"
							   ToolTipService.InitialShowDelay="2500"
								ToolTipService.ShowDuration="4000"
								VerticalAlignment="Top"
								Visibility="Visible" 
								TabIndex="1" 
								Tag="SPDatagrid"
								Height="{Binding RowHeight0, ElementName=SProcsViewer,Converter={StaticResource ReduceByParamValue} ,ConverterParameter=5}">
				<DataGrid.ToolTip>
					<Grid Height="180" Width="300" >
						<Border BorderBrush="Red" BorderThickness="2">
							<StackPanel Orientation="Vertical">
								<TextBlock TextWrapping="Wrap"
										   Background="{StaticResource White3}"
											FontSize="16"
											Text="This grid view shows ALL the records in the currently selected Sql Table."/>
								<TextBlock TextWrapping="Wrap"
										   Background="{StaticResource White3}"
														FontSize="16"
														Text=""/>
								<TextBlock TextWrapping="Wrap"
										   Background="{StaticResource White3}"
														FontSize="16"
														Text="To Edit any record, just  click on the selected entries row in the grid."/>
								<TextBlock TextWrapping="Wrap"
										   Background="{StaticResource White3}"
														FontSize="16"
														Text=""/>
								<TextBlock TextWrapping="Wrap"
															Background="{StaticResource White3}"
															FontSize="16"
															Text="Right Click for the many other available Options ! "/>
							</StackPanel>
						</Border>
					</Grid>
				</DataGrid.ToolTip>

			</DataGrid>

			<!--#endregion SProcs DataGrid-->

			<!--#region S.Procs Listbox-->

			<ListBox x:Name="SProcsListbox" 
					Grid.Row="0" Grid.Column="0" 
					ItemsSource="{Binding SProcsView}" 
					Background="{StaticResource Black2}" 
					BorderBrush="Red" 
					BorderThickness="0 0 5 0"
					FontWeight="DemiBold"
					Foreground="White"
					PreviewKeyDown="SProcsListbox_KeyDown"
					 HorizontalAlignment="Stretch"
					IsSynchronizedWithCurrentItem="True" 
					ItemContainerStyle="{StaticResource SProcsListboxStyle}" 
					d:ItemsSource="{d:SampleData ItemCount=15}"
					Margin="0 0 0 0" 
					PreviewMouseRightButtonDown="MenuControl_ExecShowContextMenu" 
					PreviewMouseRightButtonUp="DoHandled"
					PreviewMouseLeftButtonDown="SProcsListbox_MouseLeftButtonDown"
					ScrollViewer.HorizontalScrollBarVisibility="Hidden" 
					ScrollViewer.CanContentScroll="True"
					SelectionChanged="SProcsListbox_SelectionChanged" 
					SizeChanged="SProcsListbox_SizeChanged" 
					 Tag="SProcsListBox"
					ToolTipService.HasDropShadow="True"
					ToolTipService.Placement="Mouse"
					ToolTipService.BetweenShowDelay="5000"
					ToolTipService.InitialShowDelay="2500"
					ToolTipService.ShowDuration="2000"
					ToolTip="Right Click for All available Options !"					 
					VerticalAlignment="Top"
					Visibility="Visible"
					Height="{Binding RowHeight0, ElementName=SProcsViewer,Converter={StaticResource ReduceByParamValue} ,ConverterParameter=3}">
				<!--<ListBox.Height>
					-->
				<!--// This works very well, creating a dropdown list with the-->
				<!--
					<MultiBinding Converter="{StaticResource SprocsMultiConverter}">
						<Binding/>
						<Binding Path="Tag" ElementName="SProcsListBox"/>
						<Binding Path="ActualHeight" ElementName="SProcsListBox"/>
					</MultiBinding>				
				</ListBox.Height>-->

				<ListBox.ItemTemplate>
					<DataTemplate>
						<TextBlock Text="{Binding}" 
								Padding="10 0 0 0" 
								 FontSize="16"
							   Width="{Binding ActualWidth, ElementName=SProcsViewer ,
									   Converter={StaticResource ReduceByParamValue},ConverterParameter=30}">
						</TextBlock>
					</DataTemplate>
				</ListBox.ItemTemplate>
			</ListBox>

			<!--#endregion S.Procs Listbox-->

			<!--#region S.P Execute commands-->

			<ListBox x:Name="ExecList" Grid.Row="0" Grid.Column="3"  Grid.ColumnSpan="3"
					Background="{StaticResource Black0}"
					Foreground="{StaticResource White0}" 
					Grid.RowSpan="2" 
					HorizontalAlignment="Left"
					ItemsSource="{Binding ExecCommands}" 
					Margin="0 0,3,25"
					ScrollViewer.HorizontalScrollBarVisibility="Hidden" 
					ItemContainerStyle="{StaticResource ExecMethodsListboxStyle}"
					 SelectionChanged="ExecListbox_SelChanged"
					MouseDoubleClick="ExecListbox_MouseLeftButtonDown" 
					PreviewMouseRightButtonUp="DoHandled"
					PreviewMouseRightButtonDown="MenuControl_ExecShowContextMenu" 
					ToolTipService.HasDropShadow="True"
					ToolTipService.Placement="Mouse"
					ToolTipService.BetweenShowDelay="5000"
					ToolTipService.InitialShowDelay="2500"
					ToolTipService.ShowDuration="2000"
					ToolTip="Right Click for All available Options !"
					 VerticalAlignment="Top"
					Width="{Binding ActualWidth, ElementName=SPFullDataContainerGrid,
						Converter={StaticResource ReduceByParamValue} ,ConverterParameter=0}"					 
					d:ItemsSource="{d:SampleData ItemCount=15}"
                     Visibility="Visible"
					Height="{Binding RowHeight0, ElementName=SProcsViewer,Converter={StaticResource ReduceByParamValue} ,ConverterParameter=3}">

				<ListBox.ItemTemplate>
					<DataTemplate>
						<TextBlock Text="{Binding}" 
								   FontSize="16"
								Padding="10 0 0 0" MinWidth="3000" />
					</DataTemplate>
					<!--FontSize="{Binding ScrollViewerFontSize, ElementName=MainWindow}"-->
				</ListBox.ItemTemplate>
			</ListBox>

			<!--#endregion Execute commands-->

			<!--#region Grid Splitter-->

			<!--ResizeBehavior="PreviousAndNext"-->
			<GridSplitter x:Name="HSplitter" Grid.Row="1" 
								Grid.Column="0" Grid.ColumnSpan="4" 
								Height="20" 
								HorizontalAlignment="Stretch"
								Background="{StaticResource Yellow5}" 
								ResizeDirection="Rows" 
								DragCompleted="Splitter_DragCompleted"
 								DragStarted="Splitter_DragStarted"
								ShowsPreview="False"
								Margin="2 0 2 0"
								Grid.RowSpan="1"
								ToolTip="Drag ( ^ v ) Up or Down to vary the Upper/Lower panels sizes ..."
								PreviewKeyDown="HSplitter_PreviewKeyDown"
								PreviewMouseLeftButtonDown="Splitter_PreviewMouseLeftButtonDown" 
								PreviewMouseLeftButtonUp="Splitter_PreviewMouseLeftButtonUp" >
				<!--PreviewMouseRightButtonDown="MenuControl_ExecShowContextMenu"-->
				<GridSplitter.Template>
					<ControlTemplate>
						<Grid Margin="0 0 0 0" Background="{StaticResource Yellow1}">
							<!--<WrapPanel Orientation="Horizontal" 
									   Height="25" 
									   Background="{StaticResource Yellow1}"
										HorizontalAlignment="Left" 
									   Grid.Column="0" Grid.ColumnSpan="2">-->
							<TextBlock Text=" [ Drag Up/Down to vary Height of Upper/Lower panels ] " 
										Height="20"
										Padding="0 0 0 0" 
										Foreground="Black" 
										FontSize="12" 
										TextAlignment="Center"
										HorizontalAlignment="Center" 
										Width="{Binding ActualWidth, ElementName=HSplitter ,
										Converter={StaticResource ReduceByParamValue},ConverterParameter=0}"
										Margin="0,0,0,0" />
							<!--</WrapPanel>-->
						</Grid>
					</ControlTemplate>
				</GridSplitter.Template>
			</GridSplitter>

			<!--#endregion Grid Splitter-->

			<!--#region SQL Table EDIT panel-->

			<Grid x:Name="EditPanel" Grid.Row="2" 
				  Grid.RowSpan="2"
					Grid.Column="0" Grid.ColumnSpan="2"
					Background="{StaticResource Blue2}"  
					IsHitTestVisible="True"
					Width="{Binding ActualWidth, ElementName=SPFullDataContainerGrid}"
					PreviewMouseRightButtonDown="SphMenus_ExecShowDgridContextMenu"
					 VerticalAlignment="Top"
			        Panel.ZIndex="25"
					Margin="0,0,0,0"
					Visibility="Visible" 
	 				Height="{Binding RowHeight2, ElementName=SProcsViewer,Converter={StaticResource ReduceByParamValue} ,ConverterParameter=5}">

				<!--Height="{Binding RowHeight[1], ElementName=SProcsViewer,
								Converter={StaticResource ReduceByParamValue},ConverterParameter=5}"-->

				<!--#region Edit fields Region -->

				<Grid.RowDefinitions>
					<RowDefinition Height="25"/>
					<RowDefinition Height="25"/>
					<RowDefinition Height="25"/>
					<RowDefinition Height="25"/>
					<RowDefinition Height="25"/>
					<RowDefinition Height="25"/>
					<RowDefinition Height="25"/>
					<RowDefinition Height="25"/>
					<RowDefinition Height="25"/>
					<RowDefinition Height="25"/>
					<RowDefinition Height="50"/>
					<!--// Row 10-->
					<RowDefinition Height="60"/>
				</Grid.RowDefinitions>
				<Grid.ColumnDefinitions>
					<ColumnDefinition Width="388"/>
					<ColumnDefinition Width="62"/>
					<ColumnDefinition Width="*"/>
				</Grid.ColumnDefinitions>

				<!--#region labels-->

				<Label x:Name="label1" Content="field1" Grid.Row="0" Grid.Column="0" Foreground="White" Padding="10 6 0 0" FontSize="14" Grid.ColumnSpan="2"/>
				<Label x:Name="label2" Content="field2" Grid.Row="1" Grid.Column="0" Foreground="White" Padding="10 6 0 0 " FontSize="14" Grid.ColumnSpan="2" />
				<Label x:Name="label3" Content="field3" Grid.Row="2" Grid.Column="0" Foreground="White" Padding="10 6 0 0" FontSize="14" Grid.ColumnSpan="2" />
				<Label x:Name="label4" Content="field4" Grid.Row="3" Grid.Column="0" Foreground="White" Padding="10 6 0 0" FontSize="14" Grid.ColumnSpan="2" />
				<Label x:Name="label5" Content="field5" Grid.Row="4" Grid.Column="0" Foreground="White" Padding="10 6 0 0" FontSize="14" Grid.ColumnSpan="2" />
				<Label x:Name="label6" Content="field6" Grid.Row="5" Grid.Column="0" Foreground="White" Padding="10 6 0 0" FontSize="14" Grid.ColumnSpan="2" />
				<Label x:Name="label7" Content="field7" Grid.Row="6" Grid.Column="0" Foreground="White" Padding="10 6 0 0" FontSize="14" Grid.ColumnSpan="2" />
				<Label x:Name="label8" Content="field8" Grid.Row="7" Grid.Column="0" Foreground="White" Padding="10 6 0 0" FontSize="14" Grid.ColumnSpan="2" />
				<Label x:Name="label9" Content="field9" Grid.Row="8" Grid.Column="0" Foreground="White" Padding="10 6 0 0" FontSize="14" Grid.ColumnSpan="2" />
				<Label x:Name="label10" Content="field10" Grid.Row="9" Grid.Column="0" Foreground="White" Padding="10 6 0 0" FontSize="14" Grid.ColumnSpan="2" />

				<Label x:Name="label11" Content="field11" Grid.Row="0" Grid.Column="2" Foreground="White" Padding="10 6 0 0" FontSize="14" />
				<Label x:Name="label12" Content="field12" Grid.Row="1" Grid.Column="2" Foreground="White" Padding="10 6 0 0" FontSize="14" />
				<Label x:Name="label13" Content="field13" Grid.Row="2" Grid.Column="2" Foreground="White" Padding="10 6 0 0" FontSize="14" />
				<Label x:Name="label14" Content="field14" Grid.Row="3" Grid.Column="2" Foreground="White" Padding="10 6 0 0" FontSize="14" />
				<Label x:Name="label15" Content="field15" Grid.Row="4" Grid.Column="2" Foreground="White" Padding="10 6 0 0" FontSize="14" />
				<Label x:Name="label16" Content="field16" Grid.Row="5" Grid.Column="2" Foreground="White" Padding="10 6 0 0" FontSize="14" />
				<Label x:Name="label17" Content="field17" Grid.Row="6" Grid.Column="2" Foreground="White" Padding="10 6 0 0" FontSize="14" />
				<Label x:Name="label18" Content="field18" Grid.Row="7" Grid.Column="2" Foreground="White" Padding="10 6 0 0" FontSize="14" />
				<Label x:Name="label19" Content="field19" Grid.Row="8" Grid.Column="2" Foreground="White" Padding="10 6 0 0" FontSize="14" />
				<Label x:Name="label20" Content="field20" Grid.Row="9" Grid.Column="2" Foreground="White" Padding="10 6 0 0" FontSize="14" />

				<!--#endregion labels-->

				<!--#region All data fields-->

				<!--#region Column1-->

				<TextBox  x:Name="Data1"
												Grid.Row="0" Grid.Column="0" 
												FontWeight="SemiBold"
												FontSize="14"
												Text="" 
												TextChanged="UpdateList"
												Width="270" Height="20"
												Margin="155,2,25,2"
												Padding="10 -1 0 0"
												TextOptions.TextFormattingMode="Display"
												Background="{StaticResource Red8}"
												IsHitTestVisible="False"
												Foreground="Black" Grid.ColumnSpan="2"/>
				<TextBox  x:Name="Data2"
											Grid.Row="1" Grid.Column="0" 
												FontSize="14"
												Text="" 
												TextChanged="UpdateList"
												Width="270" Height="20"
												Margin="155,2,25,2"
												IsHitTestVisible="true"
												Padding="10 0 0 0"
												KeyDown="Data1_KeyDown"
												GotFocus="Data_GotFocus"
												LostFocus= "Data_LostFocus"
												Background="White" Foreground="Black" Grid.ColumnSpan="2"/>
				<TextBox  x:Name="Data3"
										Grid.Row="2" Grid.Column="0" 
												FontSize="14"
												Text="" 
												TextChanged="UpdateList"
												Width="270" Height="20"
												KeyDown="Data1_KeyDown"
												GotFocus="Data_GotFocus"
												LostFocus="Data_LostFocus"
												Margin="155,2,25,2"
												Padding="10 0 0 0"
												Background="White" Foreground="Black" Grid.ColumnSpan="2"/>
				<TextBox  x:Name="Data4"
										Grid.Row="3" Grid.Column="0" 
												FontSize="14"
												Text="" 
												TextChanged="UpdateList"
												Width="270" Height="20"
												KeyDown="Data1_KeyDown"
												GotFocus="Data_GotFocus"
												LostFocus= "Data_LostFocus"
												Margin="155,2,25,2"
												Padding="10 0 0 0"
												Background="White" Foreground="Black" Grid.ColumnSpan="2"/>
				<TextBox  x:Name="Data5"
										Grid.Row="4" Grid.Column="0" 
												FontSize="14"
												Text="" 
												TextChanged="UpdateList"
												Width="270" Height="20"
												KeyDown="Data1_KeyDown"
												GotFocus="Data_GotFocus"
												LostFocus= "Data_LostFocus"
												Margin="155,2,25,2"
												Padding="10 0 0 0"
												Background="White" Foreground="Black" Grid.ColumnSpan="2"/>
				<TextBox  x:Name="Data6"
										Grid.Row="5" Grid.Column="0" 
												FontSize="14"
												Text="" 
												TextChanged="UpdateList"
												Width="270" Height="20"
												KeyDown="Data1_KeyDown"
												GotFocus="Data_GotFocus"
												LostFocus="Data_LostFocus"
												Margin="155,2,25,2"
												Padding="10 0 0 0"
												Background="White" Foreground="Black" Grid.ColumnSpan="2"/>
				<TextBox  x:Name="Data7"
										Grid.Row="6" Grid.Column="0" 
												FontSize="14"
												Text="" 
												TextChanged="UpdateList"
												KeyDown="Data1_KeyDown"
												GotFocus="Data_GotFocus"
												LostFocus="Data_LostFocus"
												Width="270" Height="20"
												Margin="155,2,25,2"
												Padding="10 0 0 0"
												Background="White" Foreground="Black" Grid.ColumnSpan="2"/>
				<TextBox  x:Name="Data8"
										Grid.Row="7" Grid.Column="0" 
												FontSize="14"
												Text="" 
												TextChanged="UpdateList"
												Width="270" Height="20"
												KeyDown="Data1_KeyDown"
												GotFocus="Data_GotFocus"
												LostFocus="Data_LostFocus"
												Margin="155,2,25,2"
												Padding="10 0 0 0"
												Background="White" Foreground="Black" Grid.ColumnSpan="2"/>
				<TextBox  x:Name="Data9"
										Grid.Row="8" Grid.Column="0" 
												FontSize="14"
												Text="" 
												TextChanged="UpdateList"
												Width="270" Height="20"
												KeyDown="Data1_KeyDown"
												GotFocus="Data_GotFocus"
												LostFocus="Data_LostFocus"
												Margin="155,2,25,2"
												Padding="10 0 0 0"
												Background="White" Foreground="Black" Grid.ColumnSpan="2"/>
				<TextBox  x:Name="Data10"
										Grid.Row="9" Grid.Column="0" 
												FontSize="14"
												Text="" 
												TextChanged="UpdateList"
												Width="270" Height="20"
												KeyDown="Data1_KeyDown"
												GotFocus="Data_GotFocus"
												LostFocus="Data_LostFocus"
												Margin="155,2,25,2"
												Padding="10 0 0 0"
												Background="White" 
												Foreground="Black" 
												Grid.ColumnSpan="2"/>

				<!--#endregion column1-->

				<!--#region data fields-->
				<!--#region column2-->

				<TextBox  x:Name="Data11"
										Grid.Row="0" Grid.Column="2" 
												FontSize="14"
												Text="" 
												Width="250" Height="20"
												HorizontalAlignment="Left"
												KeyDown="Data1_KeyDown"
												GotFocus="Data_GotFocus"
												LostFocus="Data_LostFocus"
												Margin="90,2,0,2"
												Background="White" 
												TextChanged="UpdateList"
												Foreground="Black"/>
				<TextBox  x:Name="Data12"
										Grid.Row="1" Grid.Column="2" 
												FontSize="14"
												Text="" 
												Width="250" Height="20"			
												HorizontalAlignment="Left"
												KeyDown="Data1_KeyDown"
												GotFocus="Data_GotFocus"
												LostFocus="Data_LostFocus"
												Margin="90,2,0,2"
												Background="White" Foreground="Black"/>
				<TextBox  x:Name="Data13"
										Grid.Row="2" Grid.Column="2" 
												FontSize="14"
												Text="" 
												TextChanged="UpdateList"
												Width="250" Height="20"				
												HorizontalAlignment="Left"
												KeyDown="Data1_KeyDown"
												GotFocus="Data_GotFocus"
												LostFocus="Data_LostFocus"
												Margin="90,2,0,2"
												Background="White" Foreground="Black"/>
				<TextBox  x:Name="Data14"
										Grid.Row="3" Grid.Column="2" 
												FontSize="14"
												Text="" 
												TextChanged="UpdateList"
												HorizontalAlignment="Left"
												KeyDown="Data1_KeyDown"
												GotFocus="Data_GotFocus"
												LostFocus="Data_LostFocus"
												Width="250" Height="20"					
												Margin="90,2,0,2"
												Background="White" Foreground="Black"/>
				<TextBox  x:Name="Data15"
										Grid.Row="4" Grid.Column="2" 
												FontSize="14"
												Text="" 
												TextChanged="UpdateList"
												Width="250" Height="20"					
												HorizontalAlignment="Left"
												KeyDown="Data1_KeyDown"
												GotFocus="Data_GotFocus"
												LostFocus="Data_LostFocus"
												Margin="90,2,0,2"
												Background="White" Foreground="Black"/>
				<TextBox  x:Name="Data16"
										Grid.Row="5" Grid.Column="2" 
												FontSize="14"
												Text="" 

												TextChanged="UpdateList"
												Width="250" Height="20"					
												HorizontalAlignment="Left"
												KeyDown="Data1_KeyDown"
												GotFocus="Data_GotFocus"
												LostFocus="Data_LostFocus"
												Margin="90,2,0,2"
												Background="White" Foreground="Black"/>
				<TextBox  x:Name="Data17"
										Grid.Row="6" Grid.Column="2" 
												FontSize="14"
												Text="" 
												TextChanged="UpdateList"
												Width="250" Height="20"					
												HorizontalAlignment="Left"
												KeyDown="Data1_KeyDown"
												GotFocus="Data_GotFocus"
												LostFocus="Data_LostFocus"
												Margin="90,2,0,2"
												Background="White" Foreground="Black"/>
				<TextBox  x:Name="Data18"
										Grid.Row="7" Grid.Column="2" 
												FontSize="14"
												Text="" 
												TextChanged="UpdateList"
												Width="250" Height="20"					
												HorizontalAlignment="Left"
												KeyDown="Data1_KeyDown"
												GotFocus="Data_GotFocus"
												LostFocus="Data_LostFocus"
												Margin="90,2,0,2"
												Background="White" Foreground="Black"/>
				<TextBox  x:Name="Data19"
										Grid.Row="8" Grid.Column="2" 
												FontSize="14"
												Text="" 
												TextChanged="UpdateList"
												Width="250" Height="20"				
												HorizontalAlignment="Left"
												KeyDown="Data1_KeyDown"
												GotFocus="Data_GotFocus"
												LostFocus="Data_LostFocus"
												Margin="90,2,0,2"
												Background="White" Foreground="Black"/>
				<TextBox  x:Name="Data20"
										Grid.Row="9" Grid.Column="2" 
												FontSize="14"
												Text="" 
												TextChanged="UpdateList"
												Width="250" Height="20"				
												HorizontalAlignment="Left"
												KeyDown="Data1_KeyDown"
												GotFocus="Data_GotFocus"
												LostFocus="Data_LostFocus"
												Margin="90,2,0,2"
												Background="White" Foreground="Black"/>

				<!--#endregion column2-->
				<!--#endregion data fields-->

				<!--#region Buttons etc-->

				<Button x:Name="PreviousRec" Click="PreviousRecord"  
							Content="Previous Record"
							Grid.Row="0"
                            Grid.RowSpan="2"
							Grid.Column="4"
							HorizontalAlignment="Right"
							Margin="0,5,10,5"
							Width="130"
							Height="40"
							Style="{StaticResource DiagonalCyanButton}" RenderTransformOrigin="6.329,-5.812"/>

				<Button x:Name="NextRec" Click="NextRecord"  
							Content="Next Record ->>"
							Grid.Row="2"
                            Grid.RowSpan="2"
							Grid.Column="4"
							Grid.ColumnSpan="2"
							HorizontalAlignment="Right"
							Margin="0,5,10,5"
							Width="130"
							Height="40"
							Style="{StaticResource DiagonalCyanButton}"/>

				<Button x:Name="SaveBtn" Click="Savedata"  
							Content="Update Table !"
							Grid.Row="4"
                            Grid.RowSpan="2"
							Grid.Column="4"
							HorizontalAlignment="Right"
							Margin="0,5,10,5"
							Width="130"
							Height="40"
							Style="{StaticResource DiagonalCyanButton}"/>

				<Button x:Name="NewRec" Click="AddRecord"  
							Content="Add New Record"
							Grid.Row="6"
                            Grid.RowSpan="2"
							Grid.Column="4"
							HorizontalAlignment="Right"
							Margin="0,5,10,5"
							Width="130"
							Height="40"
							Style="{StaticResource DiagonalCyanButton}"/>

				<Button x:Name="Hidepanel" Click="ShowEditpanel_click"  
							Content="Hide edit panel"
							Grid.Row="8"
                            Grid.RowSpan="2"
							Grid.Column="4"
							HorizontalAlignment="Right"
							Margin="0,5,10,5"
							Width="130"
							Height="40"
							Style="{StaticResource DiagonalRedButton}"/>

				<!--#endregion Buttons etc-->

				<!--#region textblock fields-->
				<TextBlock x:Name="editprompt"
							Grid.Row="10" 
							Grid.ColumnSpan="3"
							Width="{Binding ActualWidth, ElementName=sprocsContainerGrid,
							Converter={StaticResource ReduceByParamValue},ConverterParameter=0}" 
							HorizontalAlignment="Left"
							TextAlignment="Center"
							   TextWrapping="Wrap"
							Margin="0,10,0,0"
							Padding="0 4 0 0"
							FontSize="16"
							Text="Make changes to the selected record of the SQL Table you require, Save changes using 'Update' button"
							Background="{StaticResource Orange3}"
							Foreground="White"
							Visibility="Visible"/>
				<!--#endregion textblock fields-->

				<!--#endregion All data fields Region -->

				<!--// End EditContainer-->

			</Grid>
			<!--#endregion Datagrid edit panel-->

			<!--#endregion EDIT panel-->

			<!--#region S.P's ScrollDocument-->

			<FlowDocumentScrollViewer x:Name="TextResult" 
						Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="4" 
						ContextMenu="{x:Null}"
						Margin="1,2,0,2" 
						HorizontalAlignment="Stretch"
						HorizontalScrollBarVisibility="Auto" 
						VerticalScrollBarVisibility="Visible"
						Background="{StaticResource White0}" 
						Foreground="{StaticResource Black0}"
						IsHitTestVisible="True"
						PreviewKeyDown="ResultsEscapeKeyDown"
						PreviewMouseRightButtonDown="MenuControl_ExecShowContextMenu" 
						ToolTipService.HasDropShadow="True"
						ToolTipService.Placement="Mouse"
						ToolTipService.BetweenShowDelay="5000"
						ToolTipService.InitialShowDelay="2500"
						ToolTipService.ShowDuration="2000"
						ToolTip="Right Click for All available Options !"
						TextOptions.TextFormattingMode="Ideal"
						PreviewMouseRightButtonUp="DoHandled" 
						TextOptions.TextRenderingMode="ClearType"
						VerticalAlignment="Top"
						Visibility="Visible"
						Document="{Binding flowDoc}"
						Height="{Binding RowHeight2, ElementName=SProcsViewer,Converter={StaticResource ReduceByParamValue} ,ConverterParameter=30}">
				<!--<FlowDocument
						PageHeight="{Binding Height, Source={x:Static app:PrintLayout.A4}}"
						 PageWidth="{Binding Width, Source={x:Static app:PrintLayout.A4}}"
						 PagePadding="{Binding Margin, Source={x:Static app:PrintLayout.A4}}"
						 ColumnWidth="{Binding ColumnWidth, Source={x:Static app:PrintLayout.A4}}"
						 FontFamily="Segoe WP"
						 FontSize="16" ColumnGap="4">-->
				<!--</FlowDocument>-->

			</FlowDocumentScrollViewer>

			<!--#endregion ScrollDocument-->

			<!--#region Results ContainerDataGrid-->

			<Grid x:Name="ResultsContainerDatagrid" Grid.Row="2" Grid.Column="0" 
					DataContext="SProcsHandling"
					Grid.ColumnSpan="4"
	 				Height="{Binding RowHeight2, ElementName=SProcsViewer,Converter={StaticResource ReduceByParamValue} ,ConverterParameter=20}"
					Width="{Binding ActualWidth, ElementName=SPFullDataContainerGrid, Converter={StaticResource ReduceByParamValue} ,ConverterParameter=28}" 
					IsHitTestVisible="True"
					Panel.ZIndex="30"
					PreviewKeyDown="ResultsEscapeKeyDown"
					VerticalAlignment="Top"
					Visibility="Collapsed">

				<!--#region results datagrid-->

				<!--Width="{Binding ActualWidth, ElementName=SProcsViewer, Converter={StaticResource ReduceByParamValue} ,ConverterParameter=125}"-->
				<DataGrid x:Name="ResultsDatagrid" Grid.Row="2" Grid.Column="0" 
					AutoGenerateColumns="true"
					Background="{StaticResource White2}"
					CellStyle="{StaticResource DataGridStyleBlue}"
					CellEditEnding="SPDatagrid_CellEditEnding"
					FontSize="16"									
					Grid.ColumnSpan="4" 
					Height="{Binding RowHeight2, ElementName=SProcsViewer,Converter={StaticResource ReduceByParamValue} ,ConverterParameter=40}"
					Width="{Binding ResultsContainerDatagrid.ActualWidth}"
					HorizontalScrollBarVisibility="Visible"
					IsEnabled="True"
					IsHitTestVisible="True"
					IsReadOnly="true"
					Loaded="SPDatagrid_Loaded"			
					Margin="2,0,2,5" 
					PreviewMouseRightButtonDown="MenuControl_ExecShowContextMenu"
					PreviewMouseRightButtonUp="DoHandled" 
					Foreground="{StaticResource Red2}"		
					Panel.ZIndex="30"
					PreviewMouseLeftButtonDown="SPDatagrid_PreviewMouseLeftButtonDown"
					PreviewMouseLeftButtonUp="SPDatagrid_PreviewMouseLeftButtonUp"
					PreviewMouseDoubleClick="ResultsDatagrid_PreviewMouseDoubleClick"
					RowEditEnding="dg_RowEditEnding"
					RowHeight="25"
					SelectionMode="Single"
					SelectionChanged="ResultsDatagrid_SelectionChanged"
					ToolTipService.Placement="Mouse"
					ToolTipService.BetweenShowDelay="2000"
					ToolTipService.InitialShowDelay="2500"
					ToolTipService.VerticalOffset="30"
					ToolTipService.ShowDuration="3000"
					ToolTip="Right Click for All available Options !" 
					VerticalAlignment="Top"
					VerticalScrollBarVisibility="Visible"
					Grid.RowSpan="1" 
					Visibility="Collapsed" >
				</DataGrid>
			</Grid>

			<!--#endregion Results DataGrid-->

			<!--#region results listbox-->

			<Grid x:Name="ResultsContainerListbox"
					DataContext="SProocsHandling"
					Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="4"
	 				Height="{Binding RowHeight2, ElementName=SProcsViewer,Converter={StaticResource ReduceByParamValue} ,ConverterParameter=5}"
				   Margin="2 3 2 0"
					Panel.ZIndex="30"
					PreviewMouseRightButtonDown="MenuControl_ExecShowContextMenu"
					Background="{StaticResource White4}"
					HorizontalAlignment="Stretch"
					Visibility="Collapsed">

				<ListBox x:Name="ResultsListBox" 					
						FontSize="16"
						BorderBrush="{StaticResource White3}"
						BorderThickness="1"
						Grid.ColumnSpan="4" 
						IsHitTestVisible="True"
						SizeChanged="SProcsListbox_SizeChanged" 
						FontWeight="DemiBold"
						Margin="5 0 5 0"
						Panel.ZIndex="30"
						PreviewKeyDown="ResultsEscapeKeyDown"
						IsSynchronizedWithCurrentItem="True" 
						VerticalAlignment="Top"
						ScrollViewer.HorizontalScrollBarVisibility="Hidden" 
						PreviewMouseDoubleClick="ResultsListBox_SelectionChanged"
						PreviewMouseRightButtonDown="MenuControl_ExecShowContextMenu"
						ScrollViewer.CanContentScroll="True"
						ItemContainerStyle="{StaticResource SProcsResultsListboxStyle}" 
						HorizontalAlignment="Stretch"
						Visibility="Collapsed" >
					<ListBox.ItemTemplate>
						<DataTemplate>
							<TextBlock Text="{Binding}" 
											Margin="-10 0 0 0"
											Padding="20 0 0 0" 
											IsHitTestVisible="True"
											IsEnabled="True"
											FontWeight="DemiBold"
											ScrollViewer.HorizontalScrollBarVisibility="Hidden"
											ScrollViewer.VerticalScrollBarVisibility="Visible"
											HorizontalAlignment="Stretch"
											MinWidth="{Binding ActualWidth, ElementName=ResultsListbox}">
							</TextBlock>
						</DataTemplate>
					</ListBox.ItemTemplate>
				</ListBox>

			</Grid>

			<!--#endregion results listbox-->

			<!--#region results textbox-->

			<Grid x:Name="ResultsContainerTextblock" Grid.Row="2" 
					Grid.Column="0" Grid.ColumnSpan="4"
					DataContext="SProocsHandling"								
					Background="{StaticResource Black2}" 
					Height="{Binding ActualHeight, ElementName=RowHeight2,Converter={StaticResource ReduceByParamValue} ,ConverterParameter=8}"
					IsHitTestVisible="True"
					Panel.ZIndex="40"
					PreviewKeyDown="ResultsEscapeKeyDown"
					Width="{Binding ActualWidth, ElementName=SPFullDataContainerGrid, Converter={StaticResource ReduceByParamValue} ,ConverterParameter=3}" 
					PreviewMouseRightButtonDown="MenuControl_ExecShowContextMenu"
					Visibility="Collapsed">

				<Grid.RowDefinitions>
					<RowDefinition Height="25"/>
					<RowDefinition Height="* "/>
				</Grid.RowDefinitions>

				<TextBlock x:Name="TextResultsBanner" Grid.Row="0" 
						   Background="{StaticResource Green5}" 
						   FontSize="16"
						   FontWeight="DemiBold"
						   Foreground="Red" 
						   Text="Generic File Editor" 
						   TextAlignment="Center"/>

				<ScrollViewer x:Name="gridscroller" Grid.Row="1"
							Height="{Binding ActualHeight, ElementName=ResultsContainerTextblock,Converter={StaticResource ReduceByParamValue} ,ConverterParameter=1}"
							MaxHeight="{Binding ResultsContainerTextblock.ActualHeight}"  Margin="0 -5 0 0">

					<TextBlock x:Name="ResultsTextbox" 
							TextAlignment="Left" 
							Margin="0 0 0 0"
							HorizontalAlignment="Stretch"
							Padding="10 0 20 0"
							TextWrapping="Wrap"
							IsEnabled =" true"
							VerticalAlignment="Top"
							ScrollViewer.CanContentScroll="True"
							ScrollViewer.VerticalScrollBarVisibility="Visible"
							Panel.ZIndex="40"
							PreviewKeyDown="ResultsEscapeKeyDown"
							PreviewMouseRightButtonDown="MenuControl_ExecShowContextMenu"
							FontSize="18"
							Foreground="{StaticResource White0}" 
							Background="{StaticResource Red1}" 
							Visibility="Collapsed"
							 Width="{Binding ActualWidth, ElementName=ResultsContainerTextblock,Converter={StaticResource ReduceByParamValue} ,ConverterParameter=0}">
					</TextBlock>
				</ScrollViewer>

			</Grid>

			<!--#endregion RESULTS textbox-->

			<!--#endregion Results ContainerDataGrid-->

			<!--#region FileEditor-->

			<Grid x:Name="EditFileContainerGrid" Grid.Row="2" 
					Grid.Column="0" Grid.ColumnSpan="4"
					DataContext="SProocsHandling"			
	 				Height="{Binding RowHeight2, ElementName=SProcsViewer,Converter={StaticResource ReduceByParamValue} ,ConverterParameter=80}"
					Background="{StaticResource White0}" 
					IsHitTestVisible="True"
					PreviewKeyDown="ResultsEscapeKeyDown"
					Panel.ZIndex="30"
					Width="{Binding ActualWidth, ElementName=SPFullDataContainerGrid
						,Converter={StaticResource ReduceByParamValue} ,ConverterParameter=0}"
					HorizontalAlignment="Left"
					PreviewMouseRightButtonDown="MenuControl_ExecShowContextMenu"
					VerticalAlignment="Top"
					Visibility="Collapsed">

				<Grid.RowDefinitions>
					<RowDefinition Height="25"/>
					<RowDefinition Height="* "/>
				</Grid.RowDefinitions>

				<TextBlock Grid.Row="0" 
						   Background="{StaticResource Green5}" 
						   FontSize="16"
						   FontWeight="DemiBold"
						   Foreground="Red" 
						   Text="Quick Viewer Utility Panel" 
						   TextAlignment="Center"/>

				<TextBox x:Name="EditFileTextbox" 
							Grid.Row="1" 
							TextAlignment="Left" 
							Padding="10 4,0 0"
							Margin="0 0 0 0"
							HorizontalAlignment="Stretch"
							TextWrapping="Wrap"
							IsEnabled =" true"
							AcceptsReturn="True"
							AcceptsTab="True"
							PreviewKeyDown="SPEditorKeyDown"
							PreviewMouseRightButtonDown="MenuControl_ExecShowContextMenu"
							FontSize="18"
							Panel.ZIndex="30"
							FontWeight="DemiBold"
							Foreground="{StaticResource Black0}" 
							Background="{StaticResource White1}" 
							VerticalScrollBarVisibility="Visible"
							VerticalAlignment="Top"
							Visibility="Collapsed"
							Width="{Binding ActualWidth, ElementName=EditFileContainerGrid,Converter={StaticResource ReduceByParamValue} ,ConverterParameter=3}"
			 				Height="{Binding Height, ElementName=EditFileContainerGrid,Converter={StaticResource ReduceByParamValue} ,ConverterParameter=10}"/>

			</Grid>

			<!--#endregion FileEditor-->

		</Grid>

		<!--#region bottom Panel -  status rows + combos etc panel-->

		<Grid x:Name="Bottompanel" Grid.Row="3" 
					Grid.RowSpan="1"
					Grid.ColumnSpan="4"
					PreviewMouseRightButtonDown="MenuControl_ExecShowContextMenu"
					VerticalAlignment="Bottom"  
					HorizontalAlignment="Stretch"
					Height="200" 
					Background="Transparent"
					Visibility="Visible">

			<!--#region grid setup-->
			<Grid.RowDefinitions>
				<RowDefinition Height="65"/>
				<RowDefinition Height="100"/>
			</Grid.RowDefinitions>

			<Grid.ColumnDefinitions>
				<ColumnDefinition Width="*" />
				<ColumnDefinition Width="*" />
				<ColumnDefinition Width="190" />
			</Grid.ColumnDefinitions>
			<!--#endregion grid setup-->

			<!--// Top 2  rows for info-->

			<!--#region inner Wrapper grid : Argumentspanels (2 rows of text)-->

			<Grid x:Name="ArgumentsContainerGrid"	 Grid.Row="0"
							Grid.RowSpan="1"
							Grid.ColumnSpan="3" 
							Panel.ZIndex="10"
							VerticalAlignment="Top"
							Height="60" 
							Background="{StaticResource Black4}"
							Margin="0,-5,0,0"
							Visibility="Visible" >

				<Grid.RowDefinitions>
					<RowDefinition Height="60"/>
					<RowDefinition Height="30"/>
				</Grid.RowDefinitions>

				<!--Top set-->
				<!--// includes SPInfopanelGrid for processing  S.Proc data entry textbox and is
						toggled ON/Off to swap with Blanker panel-->

				<!--#region S .procs processing text  rows (2) -->

				<Grid  x:Name="SPInfopanelGrid" Grid.Row="0"
										Grid.RowSpan="1"
										Margin="0 0 0 0"
										VerticalAlignment="Top"
										Visibility="Visible" >

					<Grid.RowDefinitions>
						<RowDefinition Height="30"/>
						<RowDefinition Height="30"/>
					</Grid.RowDefinitions>

					<!--#region S procs processing text  rows (2)-->
					<TextBox  x:Name="SPArguments" 	Grid.Row="0"
							Height="30" 
							Width="{Binding ActualWidth, ElementName=sprocsContainerGrid,
							Converter={StaticResource ReduceByParamValue},ConverterParameter=0}" 
							HorizontalAlignment="Center"
							IsHitTestVisible="True"
							CaretBrush="Black"
							SelectionBrush="{StaticResource Blue8}"
							SelectionOpacity="1"
							Opacity="1"
							CaretIndex="5"
							FontWeight="SemiBold"
							FontSize="18"
							VerticalAlignment="Top" 
							TextAlignment="Center" 
							Foreground="{StaticResource Black0}"
							Background="{StaticResource Cyan0}" 
							Visibility="Visible">
					</TextBox>

					<TextBlock x:Name="Parameterstop" 	Grid.Row="1"
								Height="30" 
								Width="{Binding ActualWidth, ElementName=sprocsContainerGrid,
									Converter={StaticResource ReduceByParamValue},ConverterParameter=0}" 
								VerticalAlignment="Top"
								TextAlignment="Center" 
								Background="{StaticResource Red6}" 
								Foreground="{StaticResource White1}"
								IsHitTestVisible="True"
								Opacity="1"
								Text="Arguments layout"
								HorizontalAlignment="Stretch"
								FontSize="16" 
								Margin="0 0 0 0" 
								Padding="0 4 0 0" 
								FontWeight="DemiBold"
								UseLayoutRounding="True"
								ToolTipService.ShowDuration="2000"
								ToolTip="Press F1 for detailed information on how to pass parameters" 
								ToolTipService.HasDropShadow="True"
								ToolTipService.Placement="Mouse"
								ToolTipService.BetweenShowDelay="5000"
								ToolTipService.InitialShowDelay="2500"
								Grid.RowSpan="1" 
								Visibility="Visible"/>

				</Grid>

				<!--#endregion S procs processing text  rows (2)-->

				<!--#endregion 2 info panels (row 0)-->

				<!--second set-->
				<!--// this is toggled ON/Off to swap with SPInfoPanel above-->

				<!--#region Blanker-->

				<Grid  x:Name="Blanker" 	Grid.Row="0"
						Height="60"
						VerticalAlignment="Top"
						Grid.RowSpan="1"
						Visibility="Collapsed">

					<Grid.RowDefinitions>
						<RowDefinition Height="30"/>
						<RowDefinition Height="30"/>
					</Grid.RowDefinitions>

					<!--#region blanker rows (2)-->
					<TextBox x:Name="Blankertext1" Grid.Row="0"
				Height="30" 
				BorderBrush="{StaticResource Cyan3}"
				Text="This area is used as an information and feedback panel for the Stored Procedures and "
				FontWeight="DemiBold"
				FontSize="16"
				Padding="0 0 0 0"
				Width="{Binding ActualWidth, ElementName=sprocsContainerGrid}" 
				HorizontalAlignment="Stretch"
				HorizontalContentAlignment="Center"
				TextWrapping="Wrap"
				VerticalAlignment="Top" 
				TextAlignment="Center" 
				PreviewMouseRightButtonDown="MenuControl_ExecShowContextMenu"
				BorderThickness="0"
				Background="{StaticResource Purple4}"
				Foreground="{StaticResource White0}"
				Visibility="Visible"/>

					<TextBox x:Name="Blankertext2" Grid.Row="1"
						Height="30" 
						BorderBrush="{StaticResource Cyan3}"
						Text="Execution methods processing when they are in use, and not when working with Sql Tables..."
						FontWeight="DemiBold"
						FontSize="16"
						Margin="0 0 0 0"
						Padding="0 0 0 0"
						Width="{Binding ActualWidth, ElementName=sprocsContainerGrid}" 
						HorizontalAlignment="Stretch"
						HorizontalContentAlignment="Center"
						PreviewMouseRightButtonDown="MenuControl_ExecShowContextMenu"
						TextWrapping="Wrap"
						VerticalAlignment="Top" 
						TextAlignment="Center" 
						BorderThickness="0"
						Background="{StaticResource Purple4}"
						Foreground="{StaticResource White0}"
						Visibility="Visible"/>

					<!--#endregion blanker rows (2)-->

					<!--#region ShowEditpanel button-->

					<Button x:Name="ShowEditpanel" 
							Grid.Row="1"
								Click="ReshowEditpane"
								Height="50" 
								Width="130" 
								Style="{StaticResource DiagonalPurpleButton}"
								FontSize="16"
								HorizontalAlignment="Right"
								Grid.RowSpan="2"
								Margin="0 3 10 0"
								Foreground="{StaticResource White0}"
								Visibility="Visible">
						<Button.Content>
							<StackPanel Orientation="Vertical">
								<TextBlock x:Name="shrink1"  Text="   Fit Edit "/>
								<TextBlock x:Name="shrink2" Text=" Panel fully "/>
							</StackPanel>
						</Button.Content>
					</Button>
					<!--#endregion ShowEditpanel button-->

				</Grid>

				<!--#endregion Blanker-->

			</Grid>

			<!--#endregion Argumentspanels-->

			<!--// BOTTOM PANEL All options and combo boxes are in here-->

			<!--#region user options (varous Combos)-->

			<Grid x:Name="useroptions" Grid.Row="2" Grid.Column="0"
							Grid.ColumnSpan="3"
							Grid.RowSpan="1"
							Height="145"
							Margin="0 -9 0 0"
							Background="{StaticResource Purple4}"
							VerticalAlignment="Top"
							HorizontalAlignment="Stretch"
							Visibility="Visible" >

				<Grid.ColumnDefinitions>
					<ColumnDefinition Width="*" />
					<ColumnDefinition Width="*" />
					<ColumnDefinition Width="*" />
				</Grid.ColumnDefinitions>

				<Grid  x:Name="OptionControls" Grid.Row="1" Grid.Column="0"
							   Grid.ColumnSpan="3"
								HorizontalAlignment="Stretch"
							   Opacity="1.0">
					<Grid.ColumnDefinitions>
						<ColumnDefinition Width="220" />
						<ColumnDefinition Width="220" />
						<ColumnDefinition Width="300" />
					</Grid.ColumnDefinitions>

					<!--#region left Combo-->
					<TextBlock  x:Name="Scriptoptions" 
									Grid.RowSpan="2" 
									Grid.ColumnSpan="2"
									Panel.ZIndex="14"
									Height="30" 
									Width="320"
									Background="Transparent"
									HorizontalAlignment="Center" 
									Margin="0,7,75,0" 
									Text="STORED PROCEDURES OPTION" 
									PreviewMouseRightButtonDown="MenuControl_ExecShowContextMenu"
									FontSize="16"
									Foreground="{StaticResource White0}" 
									VerticalAlignment="Top"
									Visibility="Visible" />

					<!--#region ColorCombo-->
					<TextBlock  x:Name="Hilitecolor"  Grid.Column="0"
							Width="Auto"
							Panel.ZIndex="14"
							HorizontalAlignment="Left" 
							Margin="40,35,0,0" 
							Text="Select Hilite Color" 
							FontSize="14"
							FontWeight="DemiBold"											
							PreviewMouseRightButtonDown="MenuControl_ExecShowContextMenu"
							VerticalAlignment="Top"
							Foreground="{StaticResource White0}" />

					<ComboBox x:Name="ColorsCombo" Grid.Column="0"
							BorderBrush="Black"
							BorderThickness="1"
							HorizontalAlignment="Left" 
							VerticalAlignment="Top"
							Height="25"
							Margin="20,60,0,0" 
							Width="170" 
							DropDownOpened="ColorsCombo_DropDownOpened"
							FontSize="16" 
							FontWeight="DemiBold" 
							MaxDropDownHeight="500"
							PreviewMouseRightButtonDown="MenuControl_ExecShowContextMenu"
							SelectionChanged="ColorsCombo_SelectionChanged">

						<!--THIS ACTUALLY WORKS SO ALL MENU ENTRY BACKGROUNDS ARE 
								COLORED TO MATCH THE SOLIDCOLORBRUSH COLOR NAME-->
						<ComboBox.ItemTemplate>
							<DataTemplate>
								<TextBlock x:Name="Colortxt"										   
										   Tag="Combitem"
										Padding="10 0 0 0" 
										Height="25" 
										Width="165" >
									<TextBlock.Text>
										<!--// This works very well, creating a dropdown list with the 
												background color of each entry colored to match it's name-->
										<MultiBinding Converter="{StaticResource SetComboTextConverter}">
											<!--// Important : This line correctly passes the current object to the converter
											// As do the other parameters n fact
											// providing you get the ElementName right !!!!-->
											<Binding/>
											<Binding Path="name " ElementName="CbColorsList.name"/>
										</MultiBinding>
									</TextBlock.Text>

									<TextBlock.Background>
										<!--// This works very well, creating a dropdown list with the 
												background color of each entry colored to match it's name-->
										<MultiBinding Converter="{StaticResource SetMenuColorConverter}">
											<!--// Important : This line correctly passes the current object to the converter
											// As do the other parameters n fact
											// providing you get the ElementName right !!!!-->
											<Binding/>
										</MultiBinding>
									</TextBlock.Background>

									<TextBlock.Foreground>
										<!--// This works very well, creating a dropdown list with the 
												background color of each entry colored to match it's name-->
										<MultiBinding Converter="{StaticResource ComboTextColorConverter}">
											<!--// Important : This line correctly passes the current object to the converter
											// As do the other parameters n fact
											// providing you get the ElementName right !!!!-->
											<Binding/>
										</MultiBinding>
									</TextBlock.Foreground>
								</TextBlock>
							</DataTemplate>
						</ComboBox.ItemTemplate>
					</ComboBox>
					<!--#endregion left Combo-->

					<!--#endregion ColorCombo-->

					<!--#region FontSize-->

					<!--#region middle Combo-->
					<TextBlock   x:Name="Allctrls" Grid.Row="1"  Grid.Column="1"
									Grid.RowSpan="2" 
									Grid.ColumnSpan="2"
									Panel.ZIndex="14"
									Height="30" 
									Width="320"
									Background="Transparent"
									HorizontalAlignment="Center" 
									Margin="20,7,75,0" 
									Text="ALL CONTROLS" 
									PreviewMouseRightButtonDown="MenuControl_ExecShowContextMenu"
									FontSize="16"
									FontWeight="Bold" 
									Foreground="{StaticResource White0}" 
									VerticalAlignment="Top"
									Visibility="Visible" />

					<TextBlock Grid.Row="2" Grid.Column="1" 
									Width="100" 
									HorizontalAlignment="Left"
									VerticalAlignment="Top"
									Margin="80,35,0,0" 
									Text="Select Font size" 
									PreviewMouseRightButtonDown="MenuControl_ExecShowContextMenu"
									FontSize="14" 
									Foreground="White" />

					<ComboBox x:Name="FontSizeCombo" Grid.Column="1" 
									Height="25"
									HorizontalAlignment="Left" 
									VerticalAlignment="Top"
									Margin="90,60,0,0" Width="71"
									FontSize="15" 
									FontWeight="DemiBold" 
									PreviewMouseRightButtonDown="MenuControl_ExecShowContextMenu"
									Background="{StaticResource Green3}"
									Foreground="{StaticResource White0}" 
									MaxDropDownHeight="300"
									SelectionChanged="FsizeCombo_SelectionChanged" >
						<ComboBox.ItemTemplate>
							<DataTemplate>
								<TextBlock Text="{Binding}" 
												Background="{StaticResource Green3}"
												Foreground="{StaticResource White0}" 
												FontSize="15"
												Padding="10 0 0 0" 
												Height="22" 
										   VerticalAlignment="Center"
												Width="65" >

								</TextBlock>
							</DataTemplate>
						</ComboBox.ItemTemplate>
					</ComboBox>
					<!--#endregion FontSize-->

					<!--#region  Column 2 - Datagrid options-->
					<TextBlock Grid.Column="2" x:Name="DVO"
												Grid.ColumnSpan="2" 
												Grid.RowSpan="2" 
												Width="250" 
												HorizontalAlignment="Left" 
												VerticalAlignment="Top"
												Margin="30,10,0,9"
												Text="DATAGRID VIEWER OPTIONS" 
												FontSize="14" 
												FontWeight="Bold" 
												Visibility="Visible"
												PreviewMouseRightButtonDown="MenuControl_ExecShowContextMenu"
												Foreground="{StaticResource White0}" />

					<TextBlock Grid.Column="2" Grid.ColumnSpan="2" x:Name="SCST"
												   Width="Auto"
													HorizontalAlignment="Left" 
												   Margin="50,35,0,0" 
												   Text="Select Current Sql Table" 
												   FontSize="14"
													PreviewMouseRightButtonDown="MenuControl_ExecShowContextMenu"
													VerticalAlignment="Top"
													Foreground="White" />

					<ComboBox x:Name="GridCombo"
										Height="25"
										Grid.Column="2"  Grid.ColumnSpan="3" 
										HorizontalAlignment="Left" 
										VerticalAlignment="Top"
										Margin="0,60,0,0" 
										Width="250" 
										FontSize="14" 
										FontWeight="DemiBold" 
										PreviewMouseRightButtonDown="MenuControl_ExecShowContextMenu"
										Background="{StaticResource Blue2}"
										Foreground="{StaticResource White0}" 
										MaxDropDownHeight="350"
										SelectionChanged="Datagrid_SelectionChanged" >
						<ComboBox.ItemTemplate>
							<DataTemplate>
								<TextBlock Text="{Binding}" 
																Background="{StaticResource Blue2}"
																Foreground="{StaticResource White0}"
																Padding="10 0 0 0" 
																Height="30" 
																	Width="230" />
							</DataTemplate>
						</ComboBox.ItemTemplate>
					</ComboBox>
				</Grid>
				<!--#endregion Datagrid options-->

				<!--#region Close buttons-->

				<Grid x:Name="CloseBtnGrid" Grid.Row="3" Grid.Column="3"
				  HorizontalAlignment="Right"
				  Grid.ColumnSpan="3"
				  Background="{StaticResource Purple4}"
 					Margin="0 -9 0 0">

					<Button x:Name="ExecuteBtn" Height="80"
									Grid.Column="1" Grid.RowSpan="3"
									HorizontalAlignment="Right" 
									VerticalAlignment="Top"
									Width="90" 
									Foreground="White" 
									BorderBrush="Red"							
									BorderThickness="2"
									Margin="0,22,190,0" 
									FontSize="17"
									FontWeight="Bold" 
									Click="Execute_Click" 
									Style="{StaticResource DiagonalRedButton}">
						<Button.Content>
							<StackPanel Orientation="Vertical">
								<TextBlock Text="Execute" TextAlignment="Center"/>
								<TextBlock Text="Script" TextAlignment="Center"/>
							</StackPanel>
						</Button.Content>
					</Button>

					<Button x:Name="CloseBtn" Height="40"
									Grid.Column="1" Grid.RowSpan="3"
									HorizontalAlignment="Right" 
									VerticalAlignment="Top"
									Width="166" 
									Foreground="White" 
									BorderBrush="Red"							
									BorderThickness="2"
									Margin="0,17,10,0" 
									FontSize="17"
									FontWeight="Bold" 
									Click="CloseBtn_Click" 
									Style="{StaticResource DiagonalCyanButton}"
									PreviewMouseRightButtonDown="MenuControl_ExecShowContextMenu"
									Content="Close Window"/>


					<Button x:Name="CloseApp" Height="40"
									Grid.Column="1" Grid.RowSpan="3"
									HorizontalAlignment="Right" 
									VerticalAlignment="Top"
									Width="166" 
									BorderBrush="Red"							
									BorderThickness="2"
									Margin="0,67,10,0" 
									FontSize="17"
									FontWeight="Bold" 
									Click="CloseApp_Click"
									Style="{StaticResource DiagonalRedButton}"
									PreviewMouseRightButtonDown="MenuControl_ExecShowContextMenu"
									Content="Close Application"
									Foreground="{StaticResource WarningRed}" >
						<!--<Button.DataContext>
							<local:SprocsHandlingViewmodel/>
						</Button.DataContext>-->
						<!--Command=="{Binding DataContext.SprocsHandingViewmodel, RelativeSource={RelativeSource FindAncestor,AncestorType={x:Type Class}}}"-->
						<!--Command="CloseApp_Click"-->

					</Button>
				</Grid>
				<!--#endregion Close-->

			</Grid>

			<!--#endregionuser options->-->

		</Grid>

		<!--#endregion bottom Panel - combos etc panel-->

		<!--#region very bottom row of window - Execution result textbox-->

		<!--PreviewTextInput="ExecResult_PreviewTextInput"-->
		<TextBlock x:Name="ExecResult" 
				Grid.Row="3" 
				Grid.ColumnSpan="2" 
				TextAlignment="Center" 
				PreviewMouseRightButtonDown="MenuControl_ExecShowContextMenu"
				PreviewMouseLeftButtonUp="ExecResult_PreviewMouseLeftButtonUp"
				VerticalAlignment="Bottom"
				Foreground="{StaticResource Black0}" 
				Text="{Binding StatusText}"
				Padding="0 5 0 0"
				FontSize="18"
				Panel.ZIndex="5"
				FontWeight="Normal"
				Height="34" Margin="0,0,0,0" 
				TargetUpdated="IsUpdated" >
				<!--Background="{StaticResource Green8}"--> 
				<!--Style="{StaticResource LookAtMe}"-->
			<!--<TextBlock.Style >
				<Style TargetType="TextBlock">
					<Style.Triggers>
						<Trigger Property="Text" Value=""/>
					</Style.Triggers>
					<Style.Setters>
							<Setter Property="Visibility" Value="Hidden"/>
					</Style.Setters>-->
					<!--<BeginStoryboard>
					<Storyboard>
						<ColorAnimation
                                        Storyboard.TargetProperty="(TextBlock.Background).(SolidColorBrush.Color)"
                                        From="{StaticResource ClrCyan0}" To="{StaticResource ClrYellow0}" Duration="0:0:1.5" 
                                        RepeatBehavior="1"
                                        AutoReverse="true"  />
					</Storyboard>
				</BeginStoryboard>-->
	<!--</Style>-->

		</TextBlock>

		<Image x:Name="icon1" 
			   Grid.Row="2"  Grid.Column="0" 
			   Source="images\large redcross.png" 
			   Height="29" Width="50" 
			   Margin="10,0,0,3"  
			   HorizontalAlignment="Left" 
			   VerticalAlignment="Bottom" 
			   Visibility="Visible"
			   Panel.ZIndex="10"/>

		<!--#endregion Execution result textbox-->

	</Grid>

	<!--#endregion bottom Panel - combos etc panel-->


	<!--// End of outer grid
	// End of main container grid-->

</Window>